//! Copyright (c) Microsoft Corporation. All rights reserved.
(function(n){function require(n){var i,r;if(n&&n.length>2&&n[0]=="."&&n[1]=="/"&&(n=n.slice(2)),i=t[n],typeof i=="function")return r={},t[n]=r,i(r),r;if(typeof i=="object")return i;throw"Unknown module "+n;}var t={},i="1.2.21031.0";t.Resources={},t.Resources["en-US"]={Validate_NotNullError:"{0} cannot be null.",Validate_NotNullOrEmptyError:"{0} cannot be null or empty.",Validate_InvalidId:"{0} is not valid.",Validate_TypeCheckError:"{0} is expected to be a value of type {1}, not {2}.",Validate_LengthUnexpected:"{0} is expected to have length {1}, not {2}.",Validate_InvalidUserParameter:"{0} contains an invalid user-defined query string parameter: {1}. User-defined query string parameters must not begin with a '$'.",Extensions_DefaultErrorMessage:"Unexpected failure.",Extensions_ConnectionFailureMessage:"Unexpected connection failure.",MobileServiceTable_ReadMismatchedQueryTables:"Cannot get the results of a query for table '{1}' via table '{0}'.",MobileServiceTable_InsertIdAlreadySet:"Cannot insert if the {0} member is already set.",MobileServiceLogin_AuthenticationProviderNotSupported:"Unsupported authentication provider name. Please specify one of {0}.",MobileServiceLogin_LoginErrorResponse:"Cannot start a login operation because login is already in progress.",MobileServiceLogin_InvalidResponseFormat:"Invalid format of the authentication response.",MobileServiceLogin_InvalidProvider:"The first parameter must be the name of the autentication provider or a Microsoft Account authentication token.",MobileServiceTable_NotSingleObject:"Could not get object from response {0}.",Push_ConflictWithReservedName:"Template name conflicts with reserved name '{0}'.",Push_InvalidTemplateName:"Template name can't contain ';' or ':'.",Push_NotSupportedXMLFormatAsBodyTemplateWin8:"The bodyTemplate is not in accepted XML format. The first node of the bodyTemplate should be Badge/Tile/Toast, except for the wns/raw template, which need to be a valid XML.",Push_BodyTemplateMustBeXml:"Valid XML is required for any template without a raw header.",Push_TagNoCommas:"Tags must not contain ','."},t.MobileServiceClient=function(n){function MobileServiceClient(n,t){i.isString(n,"applicationUrl"),i.notNullOrEmpty(n,"applicationUrl"),i.isString(t,"applicationKey"),this.applicationUrl=n,this.applicationKey=t||null;var u=r.getSdkInfo(),e=r.getOperatingSystemInfo(),h=u.fileVersion.split(".").slice(0,2).join(".");this.version="ZUMO/"+h+" (lang="+u.language+"; os="+e.name+"; os_version="+e.version+"; arch="+e.architecture+"; version="+u.fileVersion+")",this.currentUser=null,this._serviceFilter=null,this._login=new s(this),this.getTable=function(n){return i.isString(n,"tableName"),i.notNullOrEmpty(n,"tableName"),new o(n,this)},f&&(this.push=new f(this))}function getApplicationInstallationId(){var n=null,i="MobileServices.Installation.config",u=r.readSetting(i),f,e;if(!t.isNull(u))try{f=t.fromJson(u),n=f.applicationInstallationId}catch(o){}return t.isNullOrEmpty(n)&&(n=t.createUniqueInstallationId(),e=t.toJson({applicationInstallationId:n}),r.writeSetting(i,e)),n}var t=require("Extensions"),i=require("Validate"),r=require("Platform"),o=require("MobileServiceTable").MobileServiceTable,s=require("MobileServiceLogin").MobileServiceLogin,f,u,e;try{f=require("Push").Push}catch(h){}u={JsonApiCall:"AJ",GenericApiCall:"AG",AdditionalQueryParameters:"QS",OptimisticConcurrency:"OC",TableRefreshCall:"RF",TableReadRaw:"TR",TableReadQuery:"TQ"},e="X-ZUMO-FEATURES",n.MobileServiceClient=MobileServiceClient,r.addToMobileServicesClientNamespace({MobileServiceClient:MobileServiceClient}),MobileServiceClient.prototype.withFilter=function(n){var r,u;return i.notNull(n,"serviceFilter"),r=new MobileServiceClient(this.applicationUrl,this.applicationKey),r.currentUser=this.currentUser,u=this._serviceFilter,r._serviceFilter=t.isNull(u)?n:function(t,i,r){var f=function(n,t){u(n,i,t)};n(t,f,r)},r},MobileServiceClient.prototype._request=function(n,u,f,o,s,h,c){var l,a;t.isNull(c)&&typeof h=="function"&&(c=h,h=null),t.isNull(c)&&typeof s=="function"&&(c=s,s=null),t.isNull(c)&&typeof o=="function"&&(c=o,o=!1),t.isNull(c)&&typeof f=="function"&&(c=f,f=null),i.isString(n,"method"),i.notNullOrEmpty(n,"method"),i.isString(u,"uriFragment"),i.notNull(u,"uriFragment"),i.notNull(c,"callback"),l={type:n.toUpperCase()},l.url=t.url.isAbsoluteUrl(u)?u:t.url.combinePathSegments(this.applicationUrl,u),l.headers={},t.isNull(s)||t.extend(l.headers,s),l.headers["X-ZUMO-INSTALLATION-ID"]=MobileServiceClient._applicationInstallationId,t.isNullOrEmpty(this.applicationKey)||(l.headers["X-ZUMO-APPLICATION"]=this.applicationKey),this.currentUser&&!t.isNullOrEmpty(this.currentUser.mobileServiceAuthenticationToken)&&(l.headers["X-ZUMO-AUTH"]=this.currentUser.mobileServiceAuthenticationToken),t.isNull(MobileServiceClient._userAgent)||(l.headers["User-Agent"]=MobileServiceClient._userAgent),t.isNullOrEmpty["X-ZUMO-VERSION"]||(l.headers["X-ZUMO-VERSION"]=this.version),t.isNull(l.headers[e])&&h&&h.length&&(l.headers[e]=h.join(",")),t.isNull(f)?l.data=null:(l.data=t.isString(f)?f:t.toJson(f),t.hasProperty(l.headers,["Content-Type","content-type","CONTENT-TYPE","Content-type"])||(l.headers["Content-Type"]="application/json")),a=function(n,i){t.isNull(n)?!t.isNull(i)&&(i.status>=400||i.status===0)&&(n=t.createError(null,i),i=null):n=t.createError(n),c(n,i)},t.isNull(this._serviceFilter)||o?r.webRequest(l,a):this._serviceFilter(l,r.webRequest,a)},MobileServiceClient.prototype.loginWithOptions=r.async(function(n,t,i){this._login.loginWithOptions(n,t,i)}),MobileServiceClient.prototype.login=r.async(function(n,t,i,r){this._login.login(n,t,i,r)}),MobileServiceClient.prototype.logout=function(){this.currentUser=null},MobileServiceClient.prototype.invokeApi=r.async(function(n,r,f){var e,o,s,l,h,a,c;i.isString(n,"apiName"),t.isNull(f)&&typeof r=="function"&&(f=r,r=null),i.notNull(f,"callback"),t.isNull(r)||(e=r.parameters,t.isNull(e)||i.isValidParametersObject(r.parameters),o=r.method,s=r.body,l=r.headers),t.isNull(o)&&(o="POST"),h=t.url.combinePathSegments("api",n),t.isNull(e)||(a=t.url.getQueryString(e),h=t.url.combinePathAndQuery(h,a)),c=[],t.isNullOrEmpty(s)||c.push(t.isString(s)?u.GenericApiCall:u.JsonApiCall),t.isNull(e)||c.push(u.AdditionalQueryParameters),this._request(o,h,s,null,l,c,function(n,i){if(t.isNull(n)){var r;if(typeof i.getResponseHeader!="undefined"&&(r=i.getResponseHeader("Content-Type")),r)r.toLowerCase().indexOf("json")!==-1&&(i.result=t.fromJson(i.responseText));else try{i.result=t.fromJson(i.responseText)}catch(u){}f(null,i)}else f(n,null)})}),MobileServiceClient._applicationInstallationId=getApplicationInstallationId(),MobileServiceClient._userAgent=r.getUserAgent(),MobileServiceClient._zumoFeatures=u},t.MobileServiceTable=function(n){function MobileServiceTable(n,t){this.getTableName=function(){return n},this.getMobileServiceClient=function(){return t},this.systemProperties=0}function removeSystemProperties(n){var i={},t;for(t in n)t.substr(0,2)!=="__"&&(i[t]=n[t]);return i}function addSystemProperties(n,i,r){if(i===e.None||typeof r=="string"&&r.toLowerCase().indexOf("__systemproperties")>=0||(n=n||{},!t.isNull(n.__systemProperties)))return n;if(i===e.All)n.__systemProperties="*";else{var u=[];e.CreatedAt&i&&u.push(s.CreatedAt),e.UpdatedAt&i&&u.push(s.UpdatedAt),e.Version&i&&u.push(s.Version),n.__systemProperties=u.join(",")}return n}function getItemFromResponse(n){var r=t.fromJson(n.responseText),i;return n.getResponseHeader&&(i=n.getResponseHeader("ETag"),t.isNullOrEmpty(i)||(r.__version=getVersionFromEtag(i))),r}function setServerItemIfPreconditionFailed(n){n.request&&n.request.status===412&&(n.serverInstance=t.fromJson(n.request.responseText))}function getEtagFromVersion(n){var t=n.replace(/\"/g,'\\"');return'"'+t+'"'}function getVersionFromEtag(n){var t=n.length,i=n;return t>1&&n[0]==='"'&&n[t-1]==='"'&&(i=n.substr(1,t-2)),i.replace(/\\\"/g,'"')}function addQueryParametersFeaturesIfApplicable(n,i){var r=!1,u;if(i)if(Array.isArray(i))r=i.length>0;else if(t.isObject(i))for(u in i){r=!0;break}return r&&n.push(WindowsAzure.MobileServiceClient._zumoFeatures.AdditionalQueryParameters),n}var t=require("Extensions"),r=require("Validate"),u=require("Platform"),l=require("Query").Query,i="id",f="tables",o=["ID","Id","id","iD"],a=/^(.*?);\s*rel\s*=\s*(\w+)\s*$/,e={None:0,CreatedAt:1,UpdatedAt:2,Version:4,All:65535},s={CreatedAt:"__createdAt",UpdatedAt:"__updatedAt",Version:"__version"};u.addToMobileServicesClientNamespace({MobileServiceTable:{SystemProperties:e}}),n.MobileServiceTable=MobileServiceTable,MobileServiceTable.prototype._read=function(n,i,e){var s,p,w,y,h;t.isNull(e)&&(t.isNull(i)&&typeof n=="function"?(e=n,n=null,i=null):typeof i=="function"&&(e=i,i=null,!t.isNull(n)&&t.isObject(n)&&!t.isString(n)&&t.isNull(n.toOData)&&(i=n,n=null))),n&&t.isString(n)&&r.notNullOrEmpty(n,"query"),t.isNull(i)||r.isValidParametersObject(i,"parameters"),r.notNull(e,"callback");var l=this.getTableName(),o=null,v=null,c=[];if(t.isString(n))o=n,t.isNullOrEmpty(n)||c.push(WindowsAzure.MobileServiceClient._zumoFeatures.TableReadRaw);else if(t.isObject(n)&&!t.isNull(n.toOData)&&n.getComponents&&(c.push(WindowsAzure.MobileServiceClient._zumoFeatures.TableReadQuery),s=n.getComponents(),v=s.projection,s.table)){if(l!==s.table){p=t.format(u.getResourceString("MobileServiceTable_ReadMismatchedQueryTables"),l,s.table),e(t.createError(p),null);return}w=n.toOData(),o=w.replace(new RegExp("^/"+s.table),"")}addQueryParametersFeaturesIfApplicable(c,i),i=addSystemProperties(i,this.systemProperties,o),t.isNull(i)||(y=t.url.getQueryString(i),t.isNullOrEmpty(o)?o=y:o+="&"+y),h=o,t.url.isAbsoluteUrl(h)||(h=t.url.combinePathSegments(f,l),t.isNull(o)||(h=t.url.combinePathAndQuery(h,o))),this.getMobileServiceClient()._request("GET",h,null,!1,null,c,function(n,i){var r=null,u,o,f;if(t.isNull(n)){if(r=t.fromJson(i.responseText),r&&!Array.isArray(r)&&typeof r.count!="undefined"&&typeof r.results!="undefined"&&(r.results.totalCount=r.count,r=r.results),v!==null)for(u=0,u=0;u<r.length;u++)r[u]=v.call(r[u]);if(Array.isArray(r)&&i.getResponseHeader&&t.isNull(r.nextLink))try{o=i.getResponseHeader("Link"),t.isNullOrEmpty(o)||(f=a.exec(o),f&&f.length===3&&f[2]=="next"&&(r.nextLink=f[1]))}catch(s){}}e(n,r)})},MobileServiceTable.prototype.read=u.async(MobileServiceTable.prototype._read),MobileServiceTable.prototype.insert=u.async(function(n,e,s){var l,h,a,c,v;t.isNull(s)&&typeof e=="function"&&(s=e,e=null),r.notNull(n,"instance"),t.isNull(e)||r.isValidParametersObject(e),r.notNull(s,"callback");for(l in o)if(h=n[o[l]],!t.isNullOrZero(h))if(t.isString(h))if(o[l]!==i)throw t.format(u.getResourceString("MobileServiceTable_InsertIdAlreadySet"),i);else r.isValidId(h,i);else throw t.format(u.getResourceString("MobileServiceTable_InsertIdAlreadySet"),i);a=addQueryParametersFeaturesIfApplicable([],e),c=t.url.combinePathSegments(f,this.getTableName()),e=addSystemProperties(e,this.systemProperties),t.isNull(e)||(v=t.url.getQueryString(e),c=t.url.combinePathAndQuery(c,v)),this.getMobileServiceClient()._request("POST",c,n,!1,null,a,function(i,r){if(t.isNull(i)){var f=getItemFromResponse(r);f=u.allowPlatformToMutateOriginal(n,f),s(null,f)}else s(i,null)})}),MobileServiceTable.prototype.update=u.async(function(n,e,o){var c,a={},s=[],l,h,v;t.isNull(o)&&typeof e=="function"&&(o=e,e=null),r.notNull(n,"instance"),r.isValidId(n[i],"instance."+i),t.isNull(e)||r.isValidParametersObject(e,"parameters"),r.notNull(o,"callback"),t.isString(n[i])?(c=n.__version,l=removeSystemProperties(n)):l=n,t.isNullOrEmpty(c)||(a["If-Match"]=getEtagFromVersion(c),s.push(WindowsAzure.MobileServiceClient._zumoFeatures.OptimisticConcurrency)),s=addQueryParametersFeaturesIfApplicable(s,e),e=addSystemProperties(e,this.systemProperties),h=t.url.combinePathSegments(f,this.getTableName(),encodeURIComponent(n[i].toString())),t.isNull(e)||(v=t.url.getQueryString(e),h=t.url.combinePathAndQuery(h,v)),this.getMobileServiceClient()._request("PATCH",h,l,!1,a,s,function(i,r){if(t.isNull(i)){var f=getItemFromResponse(r);f=u.allowPlatformToMutateOriginal(n,f),o(null,f)}else setServerItemIfPreconditionFailed(i),o(i)})}),MobileServiceTable.prototype.refresh=u.async(function(n,e,o){var s,c,l,h;if(t.isNull(o)&&typeof e=="function"&&(o=e,e=null),r.notNull(n,"instance"),!t.isValidId(n[i],i)){if(typeof n[i]=="string"&&n[i]!=="")throw t.format(u.getResourceString("Validate_InvalidId"),i);else o(null,n);return}t.isNull(e)||r.isValidParametersObject(e,"parameters"),r.notNull(o,"callback"),s=t.url.combinePathSegments(f,this.getTableName()),typeof n[i]=="string"?(c=encodeURIComponent(n[i]).replace(/\'/g,"%27%27"),s=t.url.combinePathAndQuery(s,"?$filter=id eq '"+c+"'")):s=t.url.combinePathAndQuery(s,"?$filter=id eq "+encodeURIComponent(n[i].toString())),t.isNull(e)||(l=t.url.getQueryString(e),s=t.url.combinePathAndQuery(s,l)),h=[WindowsAzure.MobileServiceClient._zumoFeatures.TableRefreshCall],h=addQueryParametersFeaturesIfApplicable(h,e),this.getMobileServiceClient()._request("GET",s,n,!1,null,h,function(r,f){var e,s;t.isNull(r)?(e=t.fromJson(f.responseText),Array.isArray(e)&&(e=e[0]),e||(s=t.format(u.getResourceString("MobileServiceTable_NotSingleObject"),i),o(t.createError(s),null)),e=u.allowPlatformToMutateOriginal(n,e),o(null,e)):o(r,null)})}),MobileServiceTable.prototype.lookup=u.async(function(n,u,e){var o,s,h;t.isNull(e)&&typeof u=="function"&&(e=u,u=null),r.isValidId(n,i),t.isNull(u)||r.isValidParametersObject(u),r.notNull(e,"callback"),o=t.url.combinePathSegments(f,this.getTableName(),encodeURIComponent(n.toString())),s=addQueryParametersFeaturesIfApplicable([],u),u=addSystemProperties(u,this.systemProperties),t.isNull(u)||(h=t.url.getQueryString(u),o=t.url.combinePathAndQuery(o,h)),this.getMobileServiceClient()._request("GET",o,null,!1,null,s,function(n,i){if(t.isNull(n)){var r=getItemFromResponse(i);e(null,r)}else e(n,null)})}),MobileServiceTable.prototype.del=u.async(function(n,u,e){var h,o,s,c;t.isNull(e)&&typeof u=="function"&&(e=u,u=null),r.notNull(n,"instance"),r.isValidId(n[i],"instance."+i),r.notNull(e,"callback"),h={},o=[],t.isString(n[i])&&(t.isNullOrEmpty(n.__version)||(h["If-Match"]=getEtagFromVersion(n.__version),o.push(WindowsAzure.MobileServiceClient._zumoFeatures.OptimisticConcurrency))),o=addQueryParametersFeaturesIfApplicable(o,u),u=addSystemProperties(u,this.systemProperties),t.isNull(u)||r.isValidParametersObject(u),s=t.url.combinePathSegments(f,this.getTableName(),encodeURIComponent(n[i].toString())),t.isNull(u)||(c=t.url.getQueryString(u),s=t.url.combinePathAndQuery(s,c)),this.getMobileServiceClient()._request("DELETE",s,null,!1,h,o,function(n){t.isNull(n)||setServerItemIfPreconditionFailed(n),e(n)})});for(var c=["where","select","orderBy","orderByDescending","skip","take","includeTotalCount"],v=function(n){MobileServiceTable.prototype[n]=function(){var i=this,t=new l(i.getTableName());return t.read=u.async(function(n,r){i._read(t,n,r)}),t[n].apply(t,arguments)}},h=0;h<c.length;h++)v(c[h])},t.MobileServiceLogin=function(n){function MobileServiceLogin(n,r){t.isNull(r)&&(r=!0),i.notNull(n),i.isObject(n,"client"),this._loginState={inProcess:!1,cancelCallback:null},this.ignoreFilters=r,this.getMobileServiceClient=function(){return n},this.getLoginInProcess=function(){return this._loginState.inProcess}}function onLoginComplete(n,i,u,f){var e=null;t.isNull(n)&&(!t.isNull(i)&&t.isObject(i)&&t.isObject(i.user)&&t.isString(i.authenticationToken)?(u.currentUser=i.user,u.currentUser.mobileServiceAuthenticationToken=i.authenticationToken,e=u.currentUser):n=r.getResourceString("MobileServiceLogin_InvalidResponseFormat")),t.isNull(f)||f(n,e)}function onLoginResponse(n,i,r,u){var f=null;if(t.isNull(n))try{f=t.fromJson(i.responseText)}catch(e){n=e}onLoginComplete(n,f,r,u)}function loginWithProviderAndToken(n,i,r,f,e){var s=n.getMobileServiceClient(),o,h;n._loginState={inProcess:!0,cancelCallback:null},o=u+"/"+i,t.isNull(f)||(h=t.url.getQueryString(f),o=t.url.combinePathAndQuery(o,h)),s._request("POST",o,r,n.ignoreFilters,function(t,i){n._loginState={inProcess:!1,cancelCallback:null},onLoginResponse(t,i,s,e)})}function loginWithLoginControl(n,i,e,o,s){var c=n.getMobileServiceClient(),l=t.url.combinePathSegments(c.applicationUrl,u,i),a=null,v,h;t.isNull(o)||(v=t.url.getQueryString(o),l=t.url.combinePathAndQuery(l,v)),e||(a=t.url.combinePathSegments(c.applicationUrl,u,f)),n._loginState={inProcess:!0,cancelCallback:null},h=r.login(l,a,function(t,i){n._loginState={inProcess:!1,cancelCallback:null},onLoginComplete(t,i,c,s)}),n._loginState.inProcess&&h&&h.cancelCallback&&(n._loginState.cancelCallback=h.cancelCallback)}var t=require("Extensions"),i=require("Validate"),r=require("Platform"),u="login",f="done";n.MobileServiceLogin=MobileServiceLogin,r.addToMobileServicesClientNamespace({MobileServiceLogin:MobileServiceLogin}),MobileServiceLogin.prototype.loginWithOptions=function(n,r,u){i.isString(n,"provider"),i.notNull(n,"provider"),t.isNull(u)&&(t.isNull(r)||typeof r!="function"?i.notNull(null,"callback"):(u=r,r=null)),!r&&this._isAuthToken(n)?this.loginWithMobileServiceToken(n,u):(r=r||{},this.loginWithProvider(n,r.token,r.useSingleSignOn,r.parameters,u))},MobileServiceLogin.prototype.login=function(n,r,u,f){t.isNull(f)&&(t.isNull(u)||typeof u!="function"?t.isNull(r)||typeof r!="function"||(f=r,u=null,r=null):(f=u,u=null)),t.isNull(u)&&(t.isBool(r)?(u=r,r=null):u=!1),t.isNull(r)&&this._isAuthToken(n)&&(r=n,n=null),t.isNull(n)&&(i.notNull(r),i.isString(r)),t.isNull(r)&&(i.notNull(n),i.isString(n),n=n.toLowerCase()),t.isNull(n)?this.loginWithMobileServiceToken(r,f):(n.toLowerCase()==="windowsazureactivedirectory"&&(n="aad"),this.loginWithProvider(n,r,u,{},f))},MobileServiceLogin.prototype._isAuthToken=function(n){return n&&t.isString(n)&&n.split(".").length===3},MobileServiceLogin.prototype.loginWithMobileServiceToken=function(n,t){var r=this,f=r.getMobileServiceClient();i.isString(n,"authenticationToken"),i.notNullOrEmpty(n,"authenticationToken"),f._request("POST",u,{authenticationToken:n},r.ignoreFilters,function(n,i){onLoginResponse(n,i,f,t)})},MobileServiceLogin.prototype.loginWithProvider=function(n,u,f,e,o){if(i.isString(n,"provider"),t.isNull(u)||i.isObject(u,"token"),this._loginState.inProcess){var s=this._loginState.cancelCallback&&this._loginState.cancelCallback();if(!s)throw r.getResourceString("MobileServiceLogin_LoginErrorResponse");}n=n.toLowerCase(),t.isNull(u)?loginWithLoginControl(this,n,f,e,o):loginWithProviderAndToken(this,n,u,e,o)}},t.Push=function(n){function Push(n){this._apns=null,this._gcm=null,this._registrationManager=null,Object.defineProperties(this,{apns:{get:function(){if(!this._apns){var t=u.format("MS-PushContainer-apns-{0}",n.applicationUrl);this._registrationManager=new f(n,"apns",t),this._apns=new i(this)}return this._apns}},gcm:{get:function(){if(!this._gcm){var t=u.format("MS-PushContainer-gcm-{0}",n.applicationUrl);this._registrationManager=new f(n,"apns",t),this._gcm=new r(this)}return this._gcm}}})}function makeCoreRegistration(n,i,r){t.notNullOrEmpty(n,"pushHandle"),t.isString(n,"pushHandle"),i=="apns"&&(n=n.toUpperCase());var u={platform:i,deviceId:n};return r&&(t.isArray(r,"tags"),u.tags=r),u}var u=require("Extensions"),t=require("Validate"),e=require("Platform"),f=require("RegistrationManager").RegistrationManager,i=function(n){this._push=n},r=function(n){this._push=n};n.Push=Push,Push.prototype._register=function(n,t,i){var r=makeCoreRegistration(t,n,i);return this._registrationManager.upsertRegistration(r)},Push.prototype._registerTemplate=function(n,i,r,f,e,o){t.notNullOrEmpty(r,"name"),t.notNullOrEmpty(f,"bodyTemplate");var s=f,h=makeCoreRegistration(i,n,o);return u.isString(s)||(s=JSON.stringify(s)),h.templateName=r,h.templateBody=s,e&&(h.expiry=e),this._registrationManager.upsertRegistration(h)},Push.prototype._unregister=function(n){return t.notNullOrEmpty(n,"templateName"),this._registrationManager.deleteRegistrationWithName(n)},Push.prototype._unregisterAll=function(n){return t.notNullOrEmpty(n,"pushHandle"),this._registrationManager.deleteAllRegistrations(n)},i.prototype.registerNative=function(n,t){return this._push._register("apns",n,t)},i.prototype.registerTemplate=function(n,t,i,r,f){return u.isNull(f)&&!u.isNull(r)&&Array.isArray(r)&&(f=r,r=null),this._push._registerTemplate("apns",n,t,i,r,f)},i.prototype.unregisterNative=function(){return this._push._unregister(f.NativeRegistrationName)},i.prototype.unregisterTemplate=function(n){return this._push._unregister(n)},i.prototype.unregisterAll=function(n){return this._push._unregisterAll(n)},r.prototype.registerNative=function(n,t){return this._push._register("gcm",n,t)},r.prototype.registerTemplate=function(n,t,i,r){return this._push._registerTemplate("gcm",n,t,i,null,r)},r.prototype.unregisterNative=function(){return this._push._unregister(f.NativeRegistrationName)},r.prototype.unregisterTemplate=function(n){return this._push._unregister(n)},r.prototype.unregisterAll=function(n){return this._push._unregisterAll(n)}},t.RegistrationManager=function(n){function RegistrationManager(n,i,r){t.notNull(n,"mobileServicesClient"),this._platform=i||"wns",this._pushHttpClient=new f(n),this._storageManager=new u(r||n.applicationUrl)}var i=require("Extensions"),t=require("Validate"),r=require("Platform"),u=require("LocalStorageManager").LocalStorageManager,f=require("PushHttpClient").PushHttpClient;n.RegistrationManager=RegistrationManager,RegistrationManager.NativeRegistrationName=u.NativeRegistrationName,RegistrationManager.prototype.upsertRegistration=r.async(function(n,r){t.notNull(n,"registration"),t.notNull(r,"callback");var f=this,h=function(n){o(function(t){if(t){n(t);return}e(!1,n)})},e=function(t,i){f._pushHttpClient.upsertRegistration(n,function(r){if(t&&r&&r.request&&r.request.status===410){h(i);return}r||(f._storageManager.pushHandle=n.deviceId),i(r)})},o=function(t){f._pushHttpClient.createRegistrationId(function(i,r){if(i){t(i);return}n.registrationId=r,f._storageManager.updateRegistrationWithName(n.templateName||u.NativeRegistrationName,n.registrationId,n.deviceId),t()})},s=function(t){var s=n.templateName||u.NativeRegistrationName,r=f._storageManager.getRegistrationIdWithName(s);i.isNullOrEmpty(r)?o(function(n){if(n){t(n);return}e(!0,t)}):(n.registrationId=r,e(!0,t))};this._storageManager.isRefreshNeeded?this._refreshRegistrations(this._storageManager.pushHandle||n.deviceId,function(n){if(n){r(n);return}s(r)}):s(r)}),RegistrationManager.prototype.deleteRegistrationWithName=r.async(function(n,t){var r=this._storageManager.getRegistrationIdWithName(n),u=this;if(i.isNullOrEmpty(r)){t();return}this._pushHttpClient.unregister(r,function(i){i||u._storageManager.deleteRegistrationWithName(n),t(i)})}),RegistrationManager.prototype.deleteAllRegistrations=r.async(function(n,r){var u=this,f=this._storageManager.pushHandle,e=function(t,r){if(t){r(t);return}var e=u._storageManager.getRegistrationIds(),f=e.length,o=[];if(f===0){u._storageManager.deleteAllRegistrations(),r();return}e.map(function(t){u._pushHttpClient.unregister(t,function(t){f--,t&&o.push(t),f<=0&&(o.length===0?(u._storageManager.deleteAllRegistrations(),r()):r(i.createError("Failed to delete registrations for "+n)))})})};t.notNull(n,"pushHandle"),this._refreshRegistrations(f||n,function(t){i.isNullOrEmpty(f)||n===f?e(t,r):e(t,function(){u._refreshRegistrations(n,function(n){e(n,r)})})})}),RegistrationManager.prototype.listRegistrations=r.async(function(n,i){t.notNullOrEmpty(n),this._pushHttpClient.listRegistrations(n,this._platform,i)}),RegistrationManager.prototype._refreshRegistrations=function(n,i){var r=this;t.notNull(n,"pushHandle"),t.notNull(i,"callback"),this._pushHttpClient.listRegistrations(n,this._platform,function(t,u){t||r._storageManager.updateAllRegistrations(u,n),i(t)})}},t.LocalStorageManager=function(n){function LocalStorageManager(n){this._registrations={},this._storageKey="MobileServices.Push."+n,this._isRefreshNeeded=!1,Object.defineProperty(this,"isRefreshNeeded",{get:function(){return this._isRefreshNeeded}}),this._pushHandle=null,Object.defineProperty(this,"pushHandle",{get:function(){return r.isNull(this._pushHandle)?"":this._pushHandle},set:function(n){i.notNullOrEmpty(n,"pushHandle"),this._pushHandle!==n&&(this._pushHandle=n,this._flushToSettings())}}),this._initializeRegistrationInfoFromStorage()}var r=require("Extensions"),i=require("Validate"),u=require("Platform"),t={Version:"v1.1.0",Keys:{Version:"Version",PushHandle:"ChannelUri",Registrations:"Registrations",NativeRegistration:"$Default"}};n.LocalStorageManager=LocalStorageManager,LocalStorageManager.NativeRegistrationName=t.Keys.NativeRegistration,LocalStorageManager.prototype.getRegistrationIds=function(){var t=[],n;for(n in this._registrations)this._registrations.hasOwnProperty(n)&&t.push(this._registrations[n]);return t},LocalStorageManager.prototype.getRegistrationIdWithName=function(n){return i.notNullOrEmpty(n,"registrationName"),this._registrations[n]},LocalStorageManager.prototype.updateAllRegistrations=function(n,u){var f,e;for(i.notNull(u,"pushHandle"),n||(n=[]),this._registrations={},f=0;f<n.length;f++)e=n[f].templateName,r.isNullOrEmpty(e)&&(e=t.Keys.NativeRegistration),this._registrations[e]=n[f].registrationId;this._pushHandle=u,this._flushToSettings(),this._isRefreshNeeded=!1},LocalStorageManager.prototype.updateRegistrationWithName=function(n,t,r){i.notNullOrEmpty(n,"registrationName"),i.notNullOrEmpty(t,"registrationId"),i.notNullOrEmpty(r,"pushHandle"),this._registrations[n]=t,this._pushHandle=r,this._flushToSettings()},LocalStorageManager.prototype.deleteRegistrationWithName=function(n){i.notNullOrEmpty(n,"registrationName"),this._registrations.hasOwnProperty(n)&&(delete this._registrations[n],this._flushToSettings())},LocalStorageManager.prototype.deleteAllRegistrations=function(){this._registrations={},this._flushToSettings()},LocalStorageManager.prototype._flushToSettings=function(){var n={};n[t.Keys.Version]=t.Version,n[t.Keys.PushHandle]=this._pushHandle,n[t.Keys.Registrations]=this._registrations,u.writeSetting(this._storageKey,JSON.stringify(n))},LocalStorageManager.prototype._initializeRegistrationInfoFromStorage=function(){var n,i;this._registrations={};try{if(n=JSON.parse(u.readSetting(this._storageKey)),this._pushHandle=n[t.Keys.PushHandle],!this._pushHandle){this._isRefreshNeeded=!0;return}if(i=n[t.Keys.Version]||"",this._isRefreshNeeded=t.Version!==i.toLowerCase(),this._isRefreshNeeded)return;this._registrations=n[t.Keys.Registrations]}catch(r){this._isRefreshNeeded=!0}}},t.PushHttpClient=function(n){function PushHttpClient(n){this.mobileServicesClient=n}var i=require("Platform"),t={"If-Modified-Since":"Mon, 27 Mar 1972 00:00:00 GMT"};n.PushHttpClient=PushHttpClient,PushHttpClient.prototype.listRegistrations=function(n,i,r){this.mobileServicesClient._request("GET","/push/registrations?platform="+encodeURIComponent(i)+"&deviceId="+encodeURIComponent(n),null,null,t,function(n,t){n?r(n):r(null,JSON.parse(t.responseText))})},PushHttpClient.prototype.unregister=function(n,i){this.mobileServicesClient._request("DELETE","/push/registrations/"+encodeURIComponent(n),null,null,t,function(n){if(n&&n.request&&n.request.status===404){i();return}i(n)})},PushHttpClient.prototype.createRegistrationId=function(n){this.mobileServicesClient._request("POST","/push/registrationIds",null,null,t,function(t,i){if(t){n(t);return}var r=i.getResponseHeader("Location");n(null,r.slice(r.lastIndexOf("/")+1))})},PushHttpClient.prototype.upsertRegistration=function(n,i){this.mobileServicesClient._request("PUT","/push/registrations/"+encodeURIComponent(n.registrationId),n,null,t,i)}},t.Platform=function(t){function getBestTransport(){return e||(e=getBestProvider(l)),e}function getBestProvider(n){for(var t=0;t<n.length;t++)if(n[t].supportsCurrentRuntime())return n[t];throw new Error("Unsupported browser - no suitable providers are available.");}var u=require("Extensions"),s=require("Validate"),h=require("Promises"),c=require("Resources"),f={},r;try{r="___z",localStorage.setItem(r,r),localStorage.removeItem(r),f=localStorage}catch(y){}var e=null,l=[require("DirectAjaxTransport"),require("IframeTransport")],a=[require("WebAuthBroker"),require("CordovaPopup"),require("BrowserPopup")],o=/^(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2})(?:\.(\d*))?Z$/,v=!JSON.stringify(new Date(100)).match(/\.100Z"$/);t.async=function(n){return function(){var i=this,t=arguments;return new h.Promise(function(r,f){var e=function(n){u.isNull(n)?r.apply(null,Array.prototype.slice.call(arguments,1)):f(n)};Array.prototype.push.call(t,e);try{n.apply(i,t)}catch(o){e(u.createError(o))}})}},t.addToMobileServicesClientNamespace=function(t){var r=n.WindowsAzure=n.WindowsAzure||{},i;for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i])},t.readSetting=function(n){return f[n]},t.writeSetting=function(n,t){f[n]=t},t.webRequest=function(n,t){return getBestTransport().performRequest(n,t)},t.getUserAgent=function(){return null},t.getOperatingSystemInfo=function(){return{name:"--",version:"--",architecture:"--"}},t.getSdkInfo=function(){var n=window&&window.cordova&&window.cordova.version;return{language:n?"Cordova":"Web",fileVersion:i}},t.login=function(n,t,i){var r=/^[a-z]+:/,u="https:";return n=n.replace(r,u),t=t.replace(r,u),getBestProvider(a).login(n,t,i)},t.toJson=function(n){return JSON.stringify(n,function(n,t){if(v&&this&&u.isDate(this[n])){var i=this[n].getMilliseconds(),r=String(i+1e3).substring(1);return t.replace(o,function(n,t){return t+"."+r+"Z"})}return t})},t.tryParseIsoDateString=function(n){var t,r;if(s.isString(n),t=o.exec(n),t){var i=t[1],u=t[2]||"0",f=Math.round(1e3*Number("0."+u));if(i=i.replace(/\-/g,"/").replace("T"," "),r=Date.parse(i+" UTC"),!isNaN(r))return new Date(r+f)}return null},t.getResourceString=function(n){return c["en-US"][n]},t.allowPlatformToMutateOriginal=function(n,t){return t}},t.DirectAjaxTransport=function(t){t.name="DirectAjaxTransport",t.supportsCurrentRuntime=function(){return typeof n.XMLHttpRequest!="undefined"&&"withCredentials"in new n.XMLHttpRequest},t.performRequest=function(t,i){var f=t.headers||{},e=t.url.replace(/#.*$/,""),o=t.type?t.type.toUpperCase():"GET",r=new n.XMLHttpRequest,u;r.onreadystatechange=function(){r.readyState===4&&i(null,r)},r.open(o,e);for(u in f)t.headers.hasOwnProperty(u)&&r.setRequestHeader(u,t.headers[u]);r.send(t.data)}},t.IframeTransport=function(t){function fixupAjax(n){n&&n.status===1223&&(n.status=204)}function whenBridgeLoaded(t,f){var e=r[t];e||(e=r[t]=new u.Promise(function(r){var u=document.createElement("iframe"),e=i.getOriginRoot(window.location.href),f=function(){r(u)};u.addEventListener?u.addEventListener("load",f,!1):u.attachEvent("onload",f),u.src=t+"/crossdomain/bridge?origin="+encodeURIComponent(e),u.setAttribute("width",0),u.setAttribute("height",0),u.style.display="none",n.document.body.appendChild(u)})),e.then(f)}var u=require("Promises"),i=require("PostMessageExchange"),r=[],f=i.instance;t.name="IframeTransport",t.supportsCurrentRuntime=function(){return typeof n.postMessage!="undefined"},t.performRequest=function(n,t){var r=i.getOriginRoot(n.url);whenBridgeLoaded(r,function(i){var u={type:n.type,url:n.url,headers:n.headers,data:n.data};f.request(i.contentWindow,u,r).then(function(n){fixupAjax(n),t(null,n)},function(n){t(n,null)})})}},t.BrowserPopup=function(n){function createIntermediateIframeForLogin(n,t){var i=document.createElement("iframe");return i.name="zumo-login-receiver",i.src=n+"/crossdomain/loginreceiver?completion_origin="+encodeURIComponent(t),i.setAttribute("width",0),i.setAttribute("height",0),i.style.display="none",document.body.appendChild(i),i}var t=require("PostMessageExchange");n.supportsCurrentRuntime=function(){return!0},n.login=function(n,i,r){var u=t.getOriginRoot(window.location.href),l=t.getOriginRoot(n),s=window.navigator.userAgent.indexOf("MSIE")>=0||window.navigator.userAgent.indexOf("Trident")>=0,f=s&&createIntermediateIframeForLogin(l,u),a=s?"iframe":"postMessage",c;if(n+=n.indexOf("?")==-1?"?":"&",n+="completion_type="+a+"&completion_origin="+encodeURIComponent(u),!(u&&(u.indexOf("http:")===0||u.indexOf("https:")===0))){c="Login is only supported from http:// or https:// URLs. Please host your page in a web server.",r(c,null);return}var e=window.open(n,"_blank","location=no"),h=function(n,t){window.clearInterval(v),e.close(),window.removeEventListener?window.removeEventListener("message",o):window.detachEvent("onmessage",o),f&&f.parentNode.removeChild(f),r(n,t)},o=function(n){var i=s?f.contentWindow:e,t;if(n.source===i){try{t=JSON.parse(n.data)}catch(r){return}t&&t.type==="LoginCompleted"&&(t.oauth||t.error)&&h(t.error,t.oauth)}},v=window.setInterval(function(){e&&e.closed===!0&&h("canceled",null)},250);return window.addEventListener?window.addEventListener("message",o,!1):window.attachEvent("onmessage",o),{cancelCallback:function(){return h("canceled",null),!0}}}},t.CordovaPopup=function(n){function isRunUnderRippleEmulator(){return window.parent&&!!window.parent.ripple}function currentCordovaVersion(){return window.cordova&&window.cordova.version}function isSupportedCordovaVersion(){var n=currentCordovaVersion().match(/^(\d+).(\d+)./);if(n){var r=Number(n[1]),u=Number(n[2]),i=t;return r>i.major||r===i.major&&u>=i.minor}return!1}function hasInAppBrowser(){return!window.open}function parseOAuthResultFromDoneUrl(n){var t=extractMessageFromUrl(n,"#token="),i=extractMessageFromUrl(n,"#error=");return{oAuthToken:t?JSON.parse(t):null,error:i}}function extractMessageFromUrl(n,t){var i=n.indexOf(t);return i<0?null:decodeURIComponent(n.substring(i+t.length))}function getSpinnerMarkup(){for(var r=("webkitTransform"in document.documentElement.style)?"-webkit-":"",t=12,i="",n=0;n<t;n++)i+="<div style='-prefix-transform: rotateZ("+(180+n*360/t)+"deg);-prefix-animation-delay: "+.75*n/t+"s;'><\/div>";return["<!DOCTYPE html><html>","<head><meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1'><\/head>","<body><div id='spinner'>"+i+"<\/div>","<style type='text/css'>","    #spinner { position: absolute; top: 50%; left: 50%; -prefix-animation: spinner 10s linear infinite; }","    #spinner > div {","        background: #333; opacity: 0; position: absolute; top: 11px; left: -2px; width: 4px; height: 21px; border-radius: 2px;","        -prefix-transform-origin: 50% -11px; -prefix-animation: spinner-spoke 0.75s linear infinite;","    }","    @-prefix-keyframes spinner { 0% { -prefix-transform: rotateZ(0deg); } 100% { -prefix-transform: rotateZ(-360deg); } }","    @-prefix-keyframes spinner-spoke { 0% { opacity: 0; } 5% { opacity: 1; } 70% { opacity: 0; } 100% { opacity: 0; } }","<\/style>","<\/body><\/html>"].join("").replace(/-prefix-/g,r)}var t={major:3,minor:0};n.supportsCurrentRuntime=function(){return!!currentCordovaVersion()&&!isRunUnderRippleEmulator()},n.login=function(n,i,r){var f=currentCordovaVersion(),u,e,o;if(!isSupportedCordovaVersion(f)){u="Not a supported version of Cordova. Detected: "+f+". Required: "+t.major+"."+t.minor;throw new Error(u);}if(!hasInAppBrowser){u='A required plugin: "org.apache.cordova.inappbrowser" was not detected.';throw new Error(u);}e="<script>location.href = unescape('"+window.escape(n)+"')<\/script>",o="data:text/html,"+encodeURIComponent(getSpinnerMarkup()+e),setTimeout(function(){var n=window.open(o,"_blank","location=no"),t=!1,u=function(u){if(!t&&u.url.indexOf(i)===0){t=!0,setTimeout(function(){n.close()},500);var f=parseOAuthResultFromDoneUrl(u.url);r(f.error,f.oAuthToken)}};n.addEventListener("loadstart",u),n.addEventListener("loadstop",u),n.addEventListener("exit",function(){t||(t=!0,r("UserCancelled",null))})},500)}},t.WebAuthBroker=function(n){function isWebAuthBrokerAvailable(){return!!(window.Windows&&window.Windows.Security&&window.Windows.Security.Authentication&&window.Windows.Security.Authentication.Web&&window.Windows.Security.Authentication.Web.WebAuthenticationBroker)}n.supportsCurrentRuntime=function(){return isWebAuthBrokerAvailable()},n.login=function(n,t,i){var r=Windows.Security.Authentication.Web.WebAuthenticationBroker,h=Windows.Security.Authentication.Web.WebAuthenticationOptions.none,c=Windows.Security.Authentication.Web.WebAuthenticationStatus.success,a=Windows.ApplicationModel.Activation.ActivationKind.webAuthenticationBrokerContinuation,u=null,f=null,e=null,o,s;if(u=function(n){var r=null,e=null;if(n.responseStatus!==c)r=n;else{var u=n.responseData,f=null,t=u.indexOf("#token=");if(t>0?f=decodeURIComponent(u.substring(t+7)):(t=u.indexOf("#error="),t>0&&(r=decodeURIComponent(u.substring(t+7)))),f!==null)try{e=JSON.parse(f)}catch(o){r=o}}i(r,e)},f=function(n){i(n,null)},e=function(n){if(n.detail.kind===a){var t=n.detail.webAuthenticationResult;t.responseStatus==c?u(t):f(t),WinJS.Application.removeEventListener("activated",e)}},t)o=new Windows.Foundation.Uri(n),s=new Windows.Foundation.Uri(t),r.authenticateAndContinue?(WinJS.Application.addEventListener("activated",e,!0),r.authenticateAndContinue(o,s)):r.authenticateAsync(h,o,s).done(u,f);else{var v=r.getCurrentApplicationCallbackUri().absoluteUri,y=n+"?sso_end_uri="+encodeURIComponent(v),l=new Windows.Foundation.Uri(y);r.authenticateAndContinue?(WinJS.Application.addEventListener("activated",e,!0),r.authenticateAndContinue(l)):r.authenticateAsync(h,l).done(u,f)}}},t.Extensions=function(n){function classOf(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}var i=require("Validate"),r=require("Platform"),t=n;n.isNull=function(n){return n===null||n===undefined},n.isNullOrZero=function(n){return n===null||n===undefined||n===0||n===""},n.isNullOrEmpty=function(n){return t.isNull(n)||n.length===0},n.format=function(n){var r,u;if(i.isString(n,"message"),!t.isNullOrEmpty(n)&&arguments.length>1)for(r=1;r<arguments.length;r++)for(u="{"+(r-1)+"}";n.indexOf(u)!==-1;)n=n.replace(u,arguments[r]);return n},n.has=function(n,r){return i.notNull(r,"key"),i.isString(r,"key"),!t.isNull(n)&&n.hasOwnProperty(r)},n.hasProperty=function(n,i){for(var r=0;r<i.length;r++)if(t.has(n,i[r]))return!0;return!1},n.extend=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n},n.isObject=function(n){return t.isNull(n)||typeof n=="object"&&!t.isDate(n)},n.isValidId=function(n){if(t.isNullOrZero(n))return!1;if(t.isString(n)){if(n.length===0||n.length>255||n.trim().length===0)return!1;return n.match(/[+"\/?`\\]|[\u0000-\u001F]|[\u007F-\u009F]|^\.{1,2}$/)!==null?!1:!0}return t.isNumber(n)?n>0:!1},n.isString=function(n){return t.isNull(n)||typeof n=="string"},n.isNumber=function(n){return!t.isNull(n)&&typeof n=="number"},n.isBool=function(n){return!t.isNull(n)&&typeof n=="boolean"},n.isDate=function(n){return!t.isNull(n)&&classOf(n)=="date"},n.toJson=function(n){return r.toJson(n)},n.fromJson=function(i){var r=null;return t.isNullOrEmpty(i)||(r=JSON.parse(i,function(i,r){if(t.isString(r)&&!t.isNullOrEmpty(r)){var u=n.tryParseIsoDateString(r);if(!t.isNull(u))return u}return r})),r},n.createUniqueInstallationId=function(){var t=function(n){return"0000".substring(n.length)+n},n=function(){return t(Math.floor(Math.random()*65536).toString(16))};return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},n.mapProperties=function(n,i){var u=[],r;if(!t.isNull(n)){r=null;for(r in n)u.push(i(r,n[r]))}return u},n.pad=function(n,t,r){i.notNull(n,"value"),i.isInteger(t,"length"),i.isString(r,"ch"),i.notNullOrEmpty(r,"ch"),i.length(r,1,"ch");for(var u=n.toString();u.length<t;)u=r+u;return u},n.trimEnd=function(n,t){i.isString(n,"text"),i.notNull(n,"text"),i.isString(t,"ch"),i.notNullOrEmpty("ch","ch"),i.length(t,1,"ch");for(var r=n.length-1;r>=0&&n[r]===t;)r--;return r>=0?n.substr(0,r+1):""},n.trimStart=function(n,t){i.isString(n,"text"),i.notNull(n,"text"),i.isString(t,"ch"),i.notNullOrEmpty(t,"ch"),i.length(t,1,"ch");for(var r=0;r<n.length&&n[r]===t;)r++;return r<n.length?n.substr(r,n.length-r):""},n.compareCaseInsensitive=function(n,i){return t.isString(n)&&!t.isNullOrEmpty(n)&&(n=n.toUpperCase()),t.isString(n)&&!t.isNullOrEmpty(i)&&(i=i.toUpperCase()),n===i},n.url={separator:"/",combinePathSegments:function(){var u=[],n=0,r;for(i.notNullOrEmpty(arguments,"arguments"),n=0;n<arguments.length;n++)r=arguments[n],i.isString(r,t.format("argument[{0}]",n)),n!==0&&(r=t.trimStart(r||"",t.url.separator)),n<arguments.length-1&&(r=t.trimEnd(r||"",t.url.separator)),u.push(r);return u.reduce(function(n,i){return n+t.url.separator+i})},getQueryString:function(t){var u,f,r;i.notNull(t,"parameters"),i.isObject(t,"parameters"),u=[];for(f in t)r=t[f],n.isObject(r)&&(r=n.toJson(r)),u.push(encodeURIComponent(f)+"="+encodeURIComponent(r));return u.join("&")},combinePathAndQuery:function(r,u){return(i.notNullOrEmpty(r,"path"),i.isString(r,"path"),t.isNullOrEmpty(u))?r:(i.isString(u,"queryString"),r.indexOf("?")>=0?r+"&"+n.trimStart(u,"?"):r+"?"+n.trimStart(u,"?"))},isAbsoluteUrl:function(n){if(t.isNullOrEmpty(n))return!1;var i=n.substring(0,7).toLowerCase();return i=="http://"||i=="https:/"}},n.tryParseIsoDateString=function(n){return r.tryParseIsoDateString(n)},n.createError=function(n,i){var u={message:r.getResourceString("Extensions_DefaultErrorMessage")},e,o,f;if(u.toString=function(){return u.message},i)if(u.request=i,i.status===0)u.message=r.getResourceString("Extensions_ConnectionFailureMessage");else{e=!1,i.getResponseHeader&&(o=i.getResponseHeader("Content-Type"),o&&(e=o.toLowerCase().indexOf("text")>=0));try{f=JSON.parse(i.responseText),u.message=typeof f=="string"?f:f.error||f.description||i.statusText||r.getResourceString("Extensions_DefaultErrorMessage")}catch(s){u.message=e?i.responseText:i.statusText||r.getResourceString("Extensions_DefaultErrorMessage")}}else t.isString(n)&&!t.isNullOrEmpty(n)?u.message=n:t.isNull(n)||(u.exception=n);return u}},t.PostMessageExchange=function(t){function PostMessageExchange(){var n=this;n._lastMessageId=0,n._hasListener=!1,n._pendingMessages={}}function getOriginRoot(n){var t=parseUrl(n),i=t.port?t.port.toString():null,r=t.protocol==="http:"&&i==="80"||t.protocol==="https:"&&i==="443",u=i&&!r?":"+i:"";return t.protocol+"//"+t.hostname+u}function parseUrl(t){var i=n.document.createElement("a");return i.href=t,i}var i=require("Promises"),r=3e5;PostMessageExchange.prototype.request=function(t,u,f){var e=this,o=++e._lastMessageId,s={messageId:o,contents:u};return e._ensureHasListener(),new i.Promise(function(i,u){e._pendingMessages[o]={messageId:o,complete:i,error:u,targetWindow:t,origin:f},e._pendingMessages[o].timeoutId=n.setTimeout(function(){var n=e._pendingMessages[o];n&&(delete e._pendingMessages[o],n.error({status:0,statusText:"Timeout",responseText:null}))},r),t.postMessage(JSON.stringify(s),f)})},PostMessageExchange.prototype._ensureHasListener=function(){if(!this._hasListener){this._hasListener=!0;var n=this,t=function(){n._handleMessage.apply(n,arguments)};window.addEventListener?window.addEventListener("message",t,!1):window.attachEvent("onmessage",t)}},PostMessageExchange.prototype._handleMessage=function(t){var r=this._tryDeserializeMessage(t.data),u=r&&r.messageId,i=u&&this._pendingMessages[u],f=i&&i.targetWindow===t.source&&i.origin===getOriginRoot(t.origin);f&&(n.clearTimeout(i.timeoutId),delete this._pendingMessages[u],i.complete(r.contents))},PostMessageExchange.prototype._tryDeserializeMessage=function(n){if(!n||typeof n!="string")return null;try{return JSON.parse(n)}catch(t){return null}},t.instance=new PostMessageExchange,t.getOriginRoot=getOriginRoot},t.Promises=function(n){(function(n){"use strict";function Promise(n){this._callbackFrames=[],this._resolutionState=null,this._resolutionValueOrError=null,this._resolveSuccess=i(this._resolveSuccess,this),this._resolveError=i(this._resolveError,this),n&&n(this._resolveSuccess,this._resolveError)}var t={success:{},error:{}},i=function(n,t){return function(){n.apply(t,arguments)}},r=function(n){return n&&typeof n.then=="function"};Promise.prototype.then=function(n,t){var i={success:n,error:t,chainedPromise:new Promise};return this._resolutionState?this._invokeCallback(i):this._callbackFrames.push(i),i.chainedPromise},Promise.prototype._resolveSuccess=function(n){this._resolve(t.success,n)},Promise.prototype._resolveError=function(n){this._resolve(t.error,n)},Promise.prototype._resolve=function(n,t){if(!this._resolutionState){this._resolutionState=n,this._resolutionValueOrError=t;for(var i=0,r=this._callbackFrames.length;i<r;i++)this._invokeCallback(this._callbackFrames[i])}},Promise.prototype._invokeCallback=function(n){var u=this._resolutionState===t.success?n.success:n.error;typeof u=="function"?setTimeout(i(function(){var i,f,e=!0;try{i=u(this._resolutionValueOrError),f=t.success}catch(o){e=!1,i=o,f=t.error}e&&r(i)?i.then(n.chainedPromise._resolveSuccess,n.chainedPromise._resolveError):n.chainedPromise._resolve(f,i)},this),1):n.chainedPromise._resolve(this._resolutionState,this._resolutionValueOrError)},Promise.prototype.done=function(n,t){return this.then(n,t).then(null,function(n){setTimeout(function(){throw new Error(n);},1)}),undefined},n.Promise=Promise})(n)},t.Validate=function(n){var t=require("Extensions"),i=require("Platform");n.notNull=function(n,r){if(t.isNull(n))throw t.format(i.getResourceString("Validate_NotNullError"),r||"Value");},n.notNullOrEmpty=function(n,r){if(t.isNullOrEmpty(n))throw t.format(i.getResourceString("Validate_NotNullOrEmptyError"),r||"Value");},n.notNullOrZero=function(n,r){if(t.isNullOrZero(n))throw t.format(i.getResourceString("Validate_NotNullOrEmptyError"),r||"Value");},n.isValidId=function(n,r){if(!t.isValidId(n))throw t.format(i.getResourceString("Validate_InvalidId"),r||"id");},n.isDate=function(r,u){if(n.notNull(r,u),!t.isDate(r))throw t.format(i.getResourceString("Validate_TypeCheckError"),u||"Value","Date",typeof r);},n.isNumber=function(r,u){if(n.notNull(r,u),!t.isNumber(r))throw t.format(i.getResourceString("Validate_TypeCheckError"),u||"Value","Number",typeof r);},n.isValidParametersObject=function(r,u){n.notNull(r,u),n.isObject(r,u);for(var f in r)if(f.indexOf("$")===0)throw t.format(i.getResourceString("Validate_InvalidUserParameter"),u,f);},n.isInteger=function(r,u){if(n.notNull(r,u),n.isNumber(r,u),parseInt(r,10)!==parseFloat(r))throw t.format(i.getResourceString("Validate_TypeCheckError"),u||"Value","number",typeof r);},n.isString=function(n,r){if(!t.isString(n))throw t.format(i.getResourceString("Validate_TypeCheckError"),r||"Value","string",typeof n);},n.isObject=function(n,r){if(!t.isObject(n))throw t.format(i.getResourceString("Validate_TypeCheckError"),r||"Value","object",typeof n);},n.isArray=function(n,r){if(!Array.isArray(n))throw t.format(i.getResourceString("Validate_TypeCheckError"),r||"Value","array",typeof n);},n.length=function(r,u,f){if(n.notNull(r,f),n.isInteger(u,"length"),r.length!==u)throw t.format(i.getResourceString("Validate_LengthUnexpected"),f||"Value",u,r.length);}},t.JavaScript=function(n){(function(){var u,f,t,i,r;r=require("esprima"),u=require("./JavaScriptNodes"),i=require("./PartialEvaluator").PartialEvaluator,t=require("./JavaScriptToQueryVisitor").JavaScriptToQueryVisitor,n.JavaScript=f=function(){function JavaScript(){}return JavaScript.transformConstraint=function(n,r){var u,f;return u=JavaScript.getExpression(n,r),u.expression=i.evaluate(u),f=new t(u),f.visit(u.expression)},JavaScript.getProjectedFields=function(){return[]},JavaScript.getExpression=function(n,t){var e,o,f,c,u,i,s,h,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut;if(s="var _$$_stmt_$$_ = "+n+";",i=r.parse(s,{range:!0}),o=(i!=null?i.type:void 0)==="Program"&&(i!=null?(a=i.body)!=null?a.length:void 0:void 0)===1&&((v=i.body[0])!=null?v.type:void 0)==="VariableDeclaration"&&((k=i.body[0])!=null?(d=k.declarations)!=null?d.length:void 0:void 0)===1&&((g=i.body[0].declarations[0])!=null?g.type:void 0)==="VariableDeclarator"&&((nt=i.body[0].declarations[0])!=null?(tt=nt.init)!=null?tt.type:void 0:void 0)==="FunctionExpression"&&((it=i.body[0].declarations[0].init)!=null?(rt=it.body)!=null?rt.type:void 0:void 0)==="BlockStatement"&&((ut=i.body[0].declarations[0].init.body)!=null?(y=ut.body)!=null?y.length:void 0:void 0)===1&&((p=i.body[0].declarations[0].init.body.body[0])!=null?p.type:void 0)==="ReturnStatement"&&((w=i.body[0].declarations[0].init.body.body[0])!=null?w.argument:void 0),!o)throw"Expected a predicate with a single return statement, not "+n;if(u=(b=i.body[0].declarations[0].init.params)!=null?b.map(function(n){return n.name}):void 0,u.length>t.length)throw"Expected value(s) for parameter(s) "+u.slice(t.length);else if(t.length>u.length)throw"Expected parameter(s) for value(s) "+t.slice(u.length);for(e={},f=h=0,l=u.length;h<l;f=++h)c=u[f],e[c]=t[f];return{source:s,expression:o,environment:e}},JavaScript}()}).call(this)},t.JavaScriptNodes=function(n){(function(){var l,a,v,y,p,w,b,k,d,g,nt,e,tt,it,u,rt,ut,ft,et,ot,st,ht,ct,f,i,lt,at,vt,yt,pt,h,wt,bt,o,kt,dt,gt,r,ni,ti,ii,ri,ui,fi,ei,oi,si,c,hi,ci,s,li={}.hasOwnProperty,t=function(n,t){function ctor(){this.constructor=n}for(var i in t)li.call(t,i)&&(n[i]=t[i]);return ctor.prototype=t.prototype,n.prototype=new ctor,n.__super__=t.prototype,n};s=require("./Node"),h=s.Node,c=s.Visitor,n.JavaScriptNode=f=function(n){function JavaScriptNode(){JavaScriptNode.__super__.constructor.call(this)}return t(JavaScriptNode,n),JavaScriptNode}(h),n.JavaScriptVisitor=i=function(n){function JavaScriptVisitor(){JavaScriptVisitor.__super__.constructor.call(this)}return t(JavaScriptVisitor,n),JavaScriptVisitor.prototype.JavaScriptNode=function(n){return n},JavaScriptVisitor}(c),n.Program=kt=function(n){function Program(n){this.elements=n,Program.__super__.constructor.call(this)}return t(Program,n),Program}(f),i.prototype.Program=function(n){return n=this.JavaScriptNode(n),n.elements=this.visit(n.elements),n},n.Function=et=function(n){function Function(n,t,i){this.id=n,this.params=t,this.body=i,Function.__super__.constructor.call(this)}return t(Function,n),Function}(f),i.prototype.Function=function(n){return n=this.JavaScriptNode(n),n.id=this.visit(n.id),n.params=this.visit(n.params),n.body=this.visit(n.body),n},n.Statement=r=function(n){function Statement(){Statement.__super__.constructor.call(this)}return t(Statement,n),Statement}(f),i.prototype.Statement=function(n){return this.JavaScriptNode(n)},n.EmptyStatement=it=function(n){function EmptyStatement(){EmptyStatement.__super__.constructor.call(this)}return t(EmptyStatement,n),EmptyStatement}(f),i.prototype.EmptyStatement=function(n){return this.JavaScriptNode(n)},n.BlockStatement=p=function(n){function BlockStatement(n){this.body=n,BlockStatement.__super__.constructor.call(this)}return t(BlockStatement,n),BlockStatement}(r),i.prototype.BlockStatement=function(n){return n=this.Statement(n),n.body=this.visit(n.body),n},n.ExpressionStatement=rt=function(n){function ExpressionStatement(){ExpressionStatement.__super__.constructor.call(this)}return t(ExpressionStatement,n),ExpressionStatement}(r),i.prototype.ExpressionStatement=function(n){return this.Statement(n)},n.IfStatement=ct=function(n){function IfStatement(n,t,i){this.test=n,this.consequent=t,this.alternate=i,IfStatement.__super__.constructor.call(this)}return t(IfStatement,n),IfStatement}(r),i.prototype.IfStatement=function(n){return n=this.Statement(n),n.test=this.visit(n.test),n.consequent=this.visit(n.consequent),n.alternate=this.visit(n.alternate),n},n.LabeledStatement=lt=function(n){function LabeledStatement(n,t){this.label=n,this.body=t,LabeledStatement.__super__.constructor.call(this)}return t(LabeledStatement,n),LabeledStatement}(r),i.prototype.LabeledStatement=function(n){return n=this.Statement(n),n.label=this.visit(n.label),n.body=this.visit(n.body),n},n.BreakStatement=w=function(n){function BreakStatement(n){this.label=n,BreakStatement.__super__.constructor.call(this)}return t(BreakStatement,n),BreakStatement}(r),i.prototype.BreakStatement=function(n){return n=this.Statement(n),n.label=this.visit(n.label),n},n.ContinueStatement=g=function(n){function ContinueStatement(n){this.label=n,ContinueStatement.__super__.constructor.call(this)}return t(ContinueStatement,n),ContinueStatement}(r),i.prototype.ContinueStatement=function(n){return n=this.Statement(n),n.label=this.visit(n.label),n},n.WithStatement=ci=function(n){function WithStatement(n,t){this.object=n,this.body=t,WithStatement.__super__.constructor.call(this)}return t(WithStatement,n),WithStatement}(r),i.prototype.WithStatement=function(n){return n=this.Statement(n),n.object=this.visit(n.object),n.body=this.visit(n.body),n},n.SwitchStatement=ti=function(n){function SwitchStatement(n,t){this.discriminant=n,this.cases=t,SwitchStatement.__super__.constructor.call(this)}return t(SwitchStatement,n),SwitchStatement}(r),i.prototype.SwitchStatement=function(n){return n=this.Statement(n),n.discriminant=this.visit(n.discriminant),n.cases=this.visit(n.cases),n},n.ReturnStatement=dt=function(n){function ReturnStatement(n){this.argument=n,ReturnStatement.__super__.constructor.call(this)}return t(ReturnStatement,n),ReturnStatement}(r),i.prototype.ReturnStatement=function(n){return n=this.Statement(n),n.argument=this.visit(n.argument),n},n.ThrowStatement=ri=function(n){function ThrowStatement(n){this.argument=n,ThrowStatement.__super__.constructor.call(this)}return t(ThrowStatement,n),ThrowStatement}(r),i.prototype.ThrowStatement=function(n){return n=this.Statement(n),n.argument=this.visit(n.argument),n},n.TryStatement=ui=function(n){function TryStatement(n,t,i){this.block=n,this.handlers=t,this.finalizer=i,TryStatement.__super__.constructor.call(this)}return t(TryStatement,n),TryStatement}(r),i.prototype.TryStatement=function(n){return n=this.Statement(n),n.block=this.visit(n.block),n.handlers=this.visit(n.handlers),n.finalizer=this.visit(n.finalizer),n},n.WhileStatement=hi=function(n){function WhileStatement(n,t){this.test=n,this.body=t,WhileStatement.__super__.constructor.call(this)}return t(WhileStatement,n),WhileStatement}(r),i.prototype.WhileStatement=function(n){return n=this.Statement(n),n.test=this.visit(n.test),n.body=this.visit(n.body),n},n.DoWhileStatement=tt=function(n){function DoWhileStatement(n,t){this.body=n,this.test=t,DoWhileStatement.__super__.constructor.call(this)}return t(DoWhileStatement,n),DoWhileStatement}(r),i.prototype.DoWhileStatement=function(n){return n=this.Statement(n),n.body=this.visit(n.body),n.test=this.visit(n.test),n},n.ForStatement=ft=function(n){function ForStatement(n,t,i,r){this.init=n,this.test=t,this.update=i,this.body=r,ForStatement.__super__.constructor.call(this)}return t(ForStatement,n),ForStatement}(r),i.prototype.ForStatement=function(n){return n=this.Statement(n),n.init=this.visit(n.init),n.test=this.visit(n.test),n.update=this.visit(n.update),n.body=this.visit(n.body),n},n.ForInStatement=ut=function(n){function ForInStatement(n,t,i){this.left=n,this.right=t,this.body=i,ForInStatement.__super__.constructor.call(this)}return t(ForInStatement,n),ForInStatement}(r),i.prototype.ForInStatement=function(n){return n=this.Statement(n),n.left=this.visit(n.left),n.right=this.visit(n.right),n.body=this.visit(n.body),n},n.DebuggerStatement=nt=function(n){function DebuggerStatement(){DebuggerStatement.__super__.constructor.call(this)}return t(DebuggerStatement,n),DebuggerStatement}(r),i.prototype.DebuggerStatement=function(n){return this.Statement(n)},n.Declaration=e=function(n){function Declaration(){Declaration.__super__.constructor.call(this)}return t(Declaration,n),Declaration}(r),i.prototype.Declaration=function(n){return this.Statement(n)},n.FunctionDeclaration=ot=function(n){function FunctionDeclaration(n,t,i){this.id=n,this.params=t,this.body=i,FunctionDeclaration.__super__.constructor.call(this)}return t(FunctionDeclaration,n),FunctionDeclaration}(e),i.prototype.FunctionDeclaration=function(n){return n=this.Declaration(n),n.id=this.visit(n.id),n.params=this.visit(n.params),n.body=this.visit(n.body),n},n.VariableDeclaration=oi=function(n){function VariableDeclaration(n,t){this.declarations=n,this.kind=t,VariableDeclaration.__super__.constructor.call(this)}return t(VariableDeclaration,n),VariableDeclaration}(e),i.prototype.VariableDeclaration=function(n){return n=this.Declaration(n),n.declarations=this.visit(n.declarations),n},n.VariableDeclarator=si=function(n){function VariableDeclarator(n,t){this.id=n,this.init=t,VariableDeclarator.__super__.constructor.call(this)}return t(VariableDeclarator,n),VariableDeclarator}(f),i.prototype.VariableDeclarator=function(n){return n=this.JavaScriptNode(n),n.id=this.visit(n.id),n.init=this.visit(n.init),n},n.Expression=u=function(n){function Expression(){return Expression.__super__.constructor.apply(this,arguments)}return t(Expression,n),Expression.prototype.constuctor=function(){return Expression.__super__.constuctor.call(this)},Expression}(f),i.prototype.Expression=function(n){return this.JavaScriptNode(n)},n.ThisExpression=ii=function(n){function ThisExpression(){ThisExpression.__super__.constructor.call(this)}return t(ThisExpression,n),ThisExpression}(u),i.prototype.ThisExpression=function(n){return this.Expression(n)},n.ArrayExpression=l=function(n){function ArrayExpression(n){this.elements=n,ArrayExpression.__super__.constructor.call(this)}return t(ArrayExpression,n),ArrayExpression}(u),i.prototype.ArrayExpression=function(n){return n=this.Expression(n),n.elements=this.visit(n.elements),n},n.ObjectExpression=wt=function(n){function ObjectExpression(n){this.properties=n,ObjectExpression.__super__.constructor.call(this)}return t(ObjectExpression,n),ObjectExpression}(u),i.prototype.ObjectExpression=function(n){var t,i,u,r;for(n=this.Expression(n),r=n.properties,i=0,u=r.length;i<u;i++)t=r[i],t.key=this.visit(t.key),t.value=this.visit(t.value);return n},n.FunctionExpression=st=function(n){function FunctionExpression(n,t,i){this.id=n,this.params=t,this.body=i,FunctionExpression.__super__.constructor.call(this)}return t(FunctionExpression,n),FunctionExpression}(u),i.prototype.FunctionExpression=function(n){return n=this.Expression(n),n.id=this.visit(n.id),n.params=this.visit(n.params),n.body=this.visit(n.body),n},n.SequenceExpression=gt=function(n){function SequenceExpression(n){this.expressions=n,SequenceExpression.__super__.constructor.call(this)}return t(SequenceExpression,n),SequenceExpression}(u),i.prototype.SequenceExpression=function(n){return n=this.Expression(n),n.expressions=this.visit(n.expressions),n},n.UnaryExpression=fi=function(n){function UnaryExpression(n,t,i){this.operator=n,this.prefix=t,this.argument=i,UnaryExpression.__super__.constructor.call(this)}return t(UnaryExpression,n),UnaryExpression}(u),i.prototype.UnaryExpression=function(n){return n=this.Expression(n),n.argument=this.visit(n.argument),n},n.BinaryExpression=y=function(n){function BinaryExpression(n,t,i){this.operator=n,this.left=t,this.right=i,BinaryExpression.__super__.constructor.call(this)}return t(BinaryExpression,n),BinaryExpression}(u),i.prototype.BinaryExpression=function(n){return n=this.Expression(n),n.left=this.visit(n.left),n.right=this.visit(n.right),n},n.AssignmentExpression=v=function(n){function AssignmentExpression(n,t,i){this.operator=n,this.left=t,this.right=i,AssignmentExpression.__super__.constructor.call(this)}return t(AssignmentExpression,n),AssignmentExpression}(u),i.prototype.AssignmentExpression=function(n){return n=this.Expression(n),n.left=this.visit(n.left),n.right=this.visit(n.right),n},n.UpdateExpression=ei=function(n){function UpdateExpression(n,t,i){this.operator=n,this.argument=t,this.prefix=i,UpdateExpression.__super__.constructor.call(this)}return t(UpdateExpression,n),UpdateExpression}(u),i.prototype.UpdateExpression=function(n){return n=this.Expression(n),n.argument=this.visit(n.argument),n},n.LogicalExpression=vt=function(n){function LogicalExpression(n,t,i){this.operator=n,this.left=t,this.right=i,LogicalExpression.__super__.constructor.call(this)}return t(LogicalExpression,n),LogicalExpression}(u),i.prototype.LogicalExpression=function(n){return n=this.Expression(n),n.left=this.visit(n.left),n.right=this.visit(n.right),n},n.ConditionalExpression=d=function(n){function ConditionalExpression(n,t,i){this.test=n,this.alternate=t,this.consequent=i,ConditionalExpression.__super__.constructor.call(this)}return t(ConditionalExpression,n),ConditionalExpression}(u),i.prototype.ConditionalExpression=function(n){return n=this.Expression(n),n.test=this.visit(n.test),n.alternate=this.visit(n.alternate),n.consequent=this.visit(n.consequent),n},n.NewExpression=pt=function(n){function NewExpression(n,t){this.callee=n,this.arguments=t,NewExpression.__super__.constructor.call(this)}return t(NewExpression,n),NewExpression}(u),i.prototype.NewExpression=function(n){return n=this.Expression(n),n.callee=this.visit(n.callee),n.arguments=this.visit(n.arguments),n},n.CallExpression=b=function(n){function CallExpression(n,t){this.callee=n,this.arguments=t,CallExpression.__super__.constructor.call(this)}return t(CallExpression,n),CallExpression}(u),i.prototype.CallExpression=function(n){return n=this.Expression(n),n.callee=this.visit(n.callee),n.arguments=this.visit(n.arguments),n},n.MemberExpression=yt=function(n){function MemberExpression(n,t,i){this.object=n,this.property=t,this.computed=i,MemberExpression.__super__.constructor.call(this)}return t(MemberExpression,n),MemberExpression}(u),i.prototype.MemberExpression=function(n){return n=this.Expression(n),n.object=this.visit(n.object),n.property=this.visit(n.property),n},n.Pattern=o=function(n){function Pattern(){Pattern.__super__.constructor.call(this)}return t(Pattern,n),Pattern}(f),i.prototype.Pattern=function(n){return this.JavaScriptNode(n)},n.ObjectPattern=bt=function(n){function ObjectPattern(n){this.properties=n,ObjectPattern.__super__.constructor.call(this)}return t(ObjectPattern,n),ObjectPattern}(o),i.prototype.ObjectPattern=function(n){var t,i,u,r;for(n=this.Pattern(n),r=n.properties,i=0,u=r.length;i<u;i++)t=r[i],t.key=this.visit(t.key),t.value=this.visit(t.value);return n},n.ArrayPattern=a=function(n){function ArrayPattern(n){this.elements=n,ArrayPattern.__super__.constructor.call(this)}return t(ArrayPattern,n),ArrayPattern}(o),i.prototype.ArrayPattern=function(n){return n=this.Pattern(n),n.elements=this.visit(n.elements),n},n.SwitchCase=ni=function(n){function SwitchCase(n,t){this.test=n,this.consequent=t,SwitchCase.__super__.constructor.call(this)}return t(SwitchCase,n),SwitchCase}(f),i.prototype.SwitchCase=function(n){return n=this.JavaScriptNode(n),n.test=this.visit(n.test),n.consequent=this.visit(n.consequent),n},n.CatchClause=k=function(n){function CatchClause(n,t){this.param=n,this.body=t,CatchClause.__super__.constructor.call(this)}return t(CatchClause,n),CatchClause}(f),i.prototype.CatchClause=function(n){return n=this.JavaScriptNode(n),n.param=this.visit(n.param),n.body=this.visit(n.body),n},n.Identifier=ht=function(n){function Identifier(n){this.name=n,Identifier.__super__.constructor.call(this)}return t(Identifier,n),Identifier}(f),i.prototype.Identifier=function(n){return this.JavaScriptNode(n)},n.Literal=at=function(n){function Literal(n){this.value=n,Literal.__super__.constructor.call(this)}return t(Literal,n),Literal}(u),i.prototype.Literal=function(n){return this.Expression(n)}}).call(this)},t.JavaScriptToQueryVisitor=function(n){(function(){var r,u,t,i,f={}.hasOwnProperty,e=function(n,t){function ctor(){this.constructor=n}for(var i in t)f.call(t,i)&&(n[i]=t[i]);return ctor.prototype=t.prototype,n.prototype=new ctor,n.__super__=t.prototype,n};i=require("./Utilities"),r=require("./JavaScriptNodes"),t=require("./QueryNodes"),n.JavaScriptToQueryVisitor=u=function(n){function JavaScriptToQueryVisitor(n){this.context=n}return e(JavaScriptToQueryVisitor,n),JavaScriptToQueryVisitor.prototype.getSource=function(n){var t,i;return this.context.source.slice(n!=null?(t=n.range)!=null?t[0]:void 0:void 0,+((n!=null?(i=n.range)!=null?i[1]:void 0:void 0)-1)+1||9e9)},JavaScriptToQueryVisitor.prototype.invalid=function(n){throw"The expression '"+this.getSource(n)+"'' is not supported.";},JavaScriptToQueryVisitor.prototype.translateUnary=function(n,i){var r,u;return r=i[n.operator],r?(u=this.visit(n.argument),new t.UnaryExpression(r,u)):null},JavaScriptToQueryVisitor.prototype.translateBinary=function(n,i){var u,r,f;return r=i[n.operator],r?(u=this.visit(n.left),f=this.visit(n.right),new t.BinaryExpression(r,u,f)):null},JavaScriptToQueryVisitor.prototype.visit=function(n){var t;return t=JavaScriptToQueryVisitor.__super__.visit.call(this,n),n===t&&this.invalid(n),t},JavaScriptToQueryVisitor.prototype.MemberExpression=function(n){var i;return i=function(){var i,r,u,f;return(n!=null?(i=n.object)!=null?i.type:void 0:void 0)==="ThisExpression"&&(n!=null?(r=n.property)!=null?r.type:void 0:void 0)==="Identifier"?new t.MemberExpression(n.property.name):(n!=null?(u=n.object)!=null?u.type:void 0:void 0)==="MemberExpression"&&((f=n.object.object)!=null?f.type:void 0)==="ThisExpression"&&n.property.type==="Identifier"&&n.property.name==="length"?new t.InvocationExpression(t.Methods.Length,new t.MemberExpression(n.object.property.name)):void 0}(),i!=null?i:JavaScriptToQueryVisitor.__super__.MemberExpression.call(this,n)},JavaScriptToQueryVisitor.prototype.Literal=function(n){return new t.ConstantExpression(n.value)},JavaScriptToQueryVisitor.prototype.UnaryExpression=function(n){var i,r;return n.operator==="+"?this.visit(n.argument):(i={"!":t.UnaryOperators.Not,"-":t.UnaryOperators.Negate},(r=this.translateUnary(n,i))!=null?r:JavaScriptToQueryVisitor.__super__.UnaryExpression.call(this,n))},JavaScriptToQueryVisitor.prototype.UpdateExpression=function(n){var i,r;return i={"++":t.UnaryOperators.Increment,"--":t.UnaryOperators.Decrement},(r=this.translateUnary(n,i))!=null?r:JavaScriptToQueryVisitor.__super__.UpdateExpression.call(this,n)},JavaScriptToQueryVisitor.prototype.LogicalExpression=function(n){var i,r;return i={"&&":t.BinaryOperators.And,"||":t.BinaryOperators.Or},(r=this.translateBinary(n,i))!=null?r:JavaScriptToQueryVisitor.__super__.LogicalExpression.call(this,n)},JavaScriptToQueryVisitor.prototype.BinaryExpression=function(n){var f,e,o,u,s,r,h;return o={"+":t.BinaryOperators.Add,"-":t.BinaryOperators.Subtract,"*":t.BinaryOperators.Multiply,"/":t.BinaryOperators.Divide,"%":t.BinaryOperators.Modulo,">":t.BinaryOperators.GreaterThan,">=":t.BinaryOperators.GreaterThanOrEqual,"<":t.BinaryOperators.LessThan,"<=":t.BinaryOperators.LessThanOrEqual,"!=":t.BinaryOperators.NotEqual,"!==":t.BinaryOperators.NotEqual,"==":t.BinaryOperators.Equal,"===":t.BinaryOperators.Equal},function(){var c,l;return(h=this.translateBinary(n,o))!=null?h:n.operator==="in"&&((c=n.right)!=null?c.type:void 0)==="Literal"&&i.isArray((l=n.right)!=null?l.value:void 0)?n.right.value.length>0?(e=this.visit(n.left),t.QueryExpression.groupClauses(t.BinaryOperators.Or,function(){var o,l,h,c;for(h=n.right.value,c=[],o=0,l=h.length;o<l;o++){if(r=h[o],i.isObject(r)){if(u=function(){var n=[];for(f in r)s=r[f],n.push(s);return n}(),(u!=null?u.length:void 0)!==1)throw"in operator requires comparison objects with a single field, not "+r+" ("+JSON.stringify(r)+"), for expression '"+this.getSource(n)+"'";r=u[0]}c.push(new t.BinaryExpression(t.BinaryOperators.Equal,e,new t.ConstantExpression(r)))}return c}.call(this))):new t.BinaryExpression(t.BinaryOperators.Equal,new t.ConstantExpression(!0),new t.ConstantExpression(!1)):JavaScriptToQueryVisitor.__super__.BinaryExpression.call(this,n)}.call(this)},JavaScriptToQueryVisitor.prototype.CallExpression=function(n){var e,f,u,o,r,i,s;return u=function(t){return function(i){var r;if(((r=n.arguments)!=null?r.length:void 0)!==1)throw"Function "+i+" expects one argument in expression '"+t.getSource(n)+"'";return t.visit(n.arguments[0])}}(this),o=function(t){return function(i,r){var u;if(((u=n.arguments)!=null?u.length:void 0)!==2)throw"Function "+r+" expects two arguments in expression '"+t.getSource(n)+"'";return[i,t.visit(n.arguments[0]),t.visit(n.arguments[1])]}}(this),f=n!=null?(s=n.callee)!=null?s.value:void 0:void 0,e=function(){var e,s,h,c,l,a,v;if(f===Math.floor)return new t.InvocationExpression(t.Methods.Floor,[u("floor")]);if(f===Math.ceil)return new t.InvocationExpression(t.Methods.Ceiling,[u("ceil")]);if(f===Math.round)return new t.InvocationExpression(t.Methods.Round,[u("round")]);if(n.callee.type==="MemberExpression"&&((e=n.callee.object)!=null?e.__hasThisExp:void 0)===!0){if(r=(n!=null?(s=n.callee)!=null?(h=s.object)!=null?h.type:void 0:void 0:void 0)==="CallExpression"?this.visit(n.callee.object):new t.MemberExpression((c=n.callee.object)!=null?(l=c.property)!=null?l.name:void 0:void 0),i=(a=n.callee)!=null?(v=a.property)!=null?v.name:void 0:void 0,i==="toUpperCase")return new t.InvocationExpression(t.Methods.ToUpperCase,[r]);if(i==="toLowerCase")return new t.InvocationExpression(t.Methods.ToLowerCase,[r]);if(i==="trim")return new t.InvocationExpression(t.Methods.Trim,[r]);if(i==="indexOf")return new t.InvocationExpression(t.Methods.IndexOf,[r,u("indexOf")]);if(i==="concat")return new t.InvocationExpression(t.Methods.Concat,[r,u("concat")]);if(i==="substring"||i==="substr")return new t.InvocationExpression(t.Methods.Substring,o(r,"substring"));if(i==="replace")return new t.InvocationExpression(t.Methods.Replace,o(r,"replace"));if(i==="getFullYear"||i==="getUTCFullYear")return new t.InvocationExpression(t.Methods.Year,[r]);if(i==="getYear")return new t.BinaryExpression(t.BinaryOperators.Subtract,new t.InvocationExpression(t.Methods.Year,[r]),new t.ConstantExpression(1900));if(i==="getMonth"||i==="getUTCMonth")return new t.BinaryExpression(t.BinaryOperators.Subtract,new t.InvocationExpression(t.Methods.Month,[r]),new t.ConstantExpression(1));if(i==="getDate"||i==="getUTCDate")return new t.InvocationExpression(t.Methods.Day,[r])}}.call(this),e!=null?e:JavaScriptToQueryVisitor.__super__.CallExpression.call(this,n)},JavaScriptToQueryVisitor}(r.JavaScriptVisitor)}).call(this)},t.Node=function(n){(function(){var i,r,t;t=require("./Utilities"),n.Node=i=function(){function Node(){this.type=t.functionName(this.constructor)}return Node.prototype.type="Node",Node}(),n.Visitor=r=function(){function Visitor(){}return Visitor.prototype.visit=function(n){var u,i,f,r;if(t.isArray(n)){for(r=[],i=0,f=n.length;i<f;i++)u=n[i],r.push(this.visit(u));return r}if(n!=null?n.type:void 0){if(t.isFunction(this[n.type]))return this[n.type](n);throw"Unsupported expression "+this.getSource(n);}else return n},Visitor.prototype.getSource=function(){return null},Visitor}()}).call(this)},t.ODataProvider=function(n){(function(){var r,f,i,u,t,e={}.hasOwnProperty,o=function(n,t){function ctor(){this.constructor=n}for(var i in t)e.call(t,i)&&(n[i]=t[i]);return ctor.prototype=t.prototype,n.prototype=new ctor,n.__super__=t.prototype,n};t=require("./Utilities"),i=require("./QueryNodes"),u=require("./Query").Query,n.ODataProvider=f=function(){function ODataProvider(){}return ODataProvider.prototype.toQuery=function(n){var t,i,r;return t=this.toOData(n,!0),r="/"+t.table,i="?",t.filters&&(r+=""+i+"$filter="+t.filters,i="&"),t.orderClauses&&(r+=""+i+"$orderby="+t.orderClauses,i="&"),t.skip&&(r+=""+i+"$skip="+t.skip,i="&"),(t.take||t.take===0)&&(r+=""+i+"$top="+t.take,i="&"),t.selections&&(r+=""+i+"$select="+t.selections,i="&"),t.includeTotalCount&&(r+=""+i+"$inlinecount=allpages"),r},ODataProvider.prototype.toOData=function(n,t){var s,i,u,f,e,o,h,c;return t==null&&(t=!1),i=(h=n!=null?n.getComponents():void 0)!=null?h:{},o=function(){var n,t;n=i!=null?i.ordering:void 0,t=[];for(u in n)s=n[u],t.push(s?u:""+u+" desc");return t}(),e=function(){var n,u,t,r;for(t=i!=null?i.orderClauses:void 0,r=[],n=0,u=t.length;n<u;n++)f=t[n],r.push(f.ascending?f.name:""+f.name+" desc");return r}(),{table:i!=null?i.table:void 0,filters:r.convert(i.filters,t),ordering:o!=null?o.toString():void 0,orderClauses:e!=null?e.toString():void 0,skip:i!=null?i.skip:void 0,take:i!=null?i.take:void 0,selections:i!=null?(c=i.selections)!=null?c.toString():void 0:void 0,includeTotalCount:i!=null?i.includeTotalCount:void 0}},ODataProvider.prototype.fromOData=function(n,t,i,r,f,e,o){var a,h,w,s,c,l,b,k,d,v,y,p;for(s=new u(n),t&&s.where(t),(r||r===0)&&s.skip(r),(f||f===0)&&s.take(f),o&&s.includeTotalCount(),v=(d=e!=null?e.split(","):void 0)!=null?d:[],c=0,b=v.length;c<b;c++)h=v[c],s.select(h.trim());for(y=function(){var n,u,f,t,r;for(t=(f=i!=null?i.split(","):void 0)!=null?f:[],r=[],n=0,u=t.length;n<u;n++)w=t[n],r.push(w.trim().split(" "));return r}(),l=0,k=y.length;l<k;l++)p=y[l],h=p[0],a=p[1],(a!=null?a.toUpperCase():void 0)!=="DESC"?s.orderBy(h):s.orderByDescending(h);return s},ODataProvider}(),r=function(n){function ODataFilterQueryVisitor(n){this.encodeForUri=n}return o(ODataFilterQueryVisitor,n),ODataFilterQueryVisitor.convert=function(n,t){var i,r;return i=new ODataFilterQueryVisitor(t),(r=n?i.visit(n):void 0)!=null?r:null},ODataFilterQueryVisitor.prototype.toOData=function(n){var i;if(t.isNumber(n)||t.isBoolean(n))return n.toString();if(t.isString(n))return n=n.replace(/'/g,"''"),this.encodeForUri!=null&&this.encodeForUri===!0&&(n=encodeURIComponent(n)),"'"+n+"'";if(t.isDate(n))return i=JSON.stringify(n),i.length>2&&(i=i.slice(1,+(i.length-2)+1||9e9)),i=i.replace(/(T\d{2}:\d{2}:\d{2})Z$/,function(t,i){var r;return r=String(n.getMilliseconds()+1e3).substring(1),""+i+"."+r+"Z"}),"datetime'"+i+"'";if(n)throw"Unsupported literal value "+n;else return"null"},ODataFilterQueryVisitor.prototype.ConstantExpression=function(n){return this.toOData(n.value)},ODataFilterQueryVisitor.prototype.MemberExpression=function(n){return n.member},ODataFilterQueryVisitor.prototype.UnaryExpression=function(n){if(n.operator===i.UnaryOperators.Not)return"not "+this.visit(n.operand);if(n.operator===i.UnaryOperators.Negate)return"(0 sub "+this.visit(n.operand)+")";throw"Unsupported operator "+n.operator;},ODataFilterQueryVisitor.prototype.BinaryExpression=function(n){var i,t;if(i={And:"and",Or:"or",Add:"add",Subtract:"sub",Multiply:"mul",Divide:"div",Modulo:"mod",GreaterThan:"gt",GreaterThanOrEqual:"ge",LessThan:"lt",LessThanOrEqual:"le",NotEqual:"ne",Equal:"eq"},t=i[n.operator],t)return"("+this.visit(n.left)+" "+t+" "+this.visit(n.right)+")";throw"Unsupported operator "+n.operator;},ODataFilterQueryVisitor.prototype.InvocationExpression=function(n){var i,t;if(i={Length:"length",ToUpperCase:"toupper",ToLowerCase:"tolower",Trim:"trim",IndexOf:"indexof",Replace:"replace",Substring:"substring",Concat:"concat",Day:"day",Month:"month",Year:"year",Floor:"floor",Ceiling:"ceiling",Round:"round"},t=i[n.method],t)return""+t+"("+this.visit(n.args)+")";throw"Invocation of unsupported method "+n.method;},ODataFilterQueryVisitor.prototype.LiteralExpression=function(n){var t,u,i,r,f,o,e;for(i="",r=0,u=!1,e=n.queryString,f=0,o=e.length;f<o;f++)if(t=e[f],r<0)break;else if(u)i+=t,u=t!=="'";else if(t==="?"){if(!n.args||n.args.length<=0)throw"Too few arguments for "+n.queryString+".";i+=this.toOData(n.args.shift())}else t==="'"?(i+=t,u=!0):t==="("?(r+=1,i+=t):t===")"?(r-=1,i+=t):i+=t;if(n.args&&n.args.length>0)throw"Too many arguments for "+n.queryString;if(r!==0)throw"Unbalanced parentheses in "+n.queryString;return i.trim().length>0?"("+i+")":i},ODataFilterQueryVisitor}(i.QueryExpressionVisitor)}).call(this)},t.PartialEvaluator=function(n){(function(){var r,t,f,i,e={}.hasOwnProperty,u=function(n,t){function ctor(){this.constructor=n}for(var i in t)e.call(t,i)&&(n[i]=t[i]);return ctor.prototype=t.prototype,n.prototype=new ctor,n.__super__=t.prototype,n};i=require("./Utilities"),t=require("./JavaScriptNodes"),n.PartialEvaluator=f=function(n){function PartialEvaluator(n){this.context=n}return u(PartialEvaluator,n),PartialEvaluator.prototype.visit=function(n){var i,u,f,e,r,o,s,h,c,l;return n.__independent&&n.type!=="Literal"&&n.type?n.type==="Identifier"&&this.context.environment[n.name]?new t.Literal(this.context.environment[n.name]):(f=this.context.source.slice(n!=null?(s=n.range)!=null?s[0]:void 0:void 0,+((n!=null?(h=n.range)!=null?h[1]:void 0:void 0)-1)+1||9e9),u=(c=function(){var n,t;n=this.context.environment,t=[];for(i in n)r=n[i],t.push(i);return t}.call(this))!=null?c:[],o=(l=function(){var n,t;n=this.context.environment,t=[];for(i in n)r=n[i],t.push(JSON.stringify(r));return t}.call(this))!=null?l:[],e="(function("+u+") { return "+f+"; })("+o+")",r=eval(e),new t.Literal(r)):PartialEvaluator.__super__.visit.call(this,n)},PartialEvaluator.evaluate=function(n){var t,i;return i=new r(n),i.visit(n.expression),t=new PartialEvaluator(n),t.visit(n.expression)},PartialEvaluator}(t.JavaScriptVisitor),n.IndependenceNominator=r=function(n){function IndependenceNominator(n){this.context=n}return u(IndependenceNominator,n),IndependenceNominator.prototype.Literal=function(n){return IndependenceNominator.__super__.Literal.call(this,n),n.__independent=!0,n.__hasThisExp=!1,n},IndependenceNominator.prototype.ThisExpression=function(n){return IndependenceNominator.__super__.ThisExpression.call(this,n),n.__independent=!1,n.__hasThisExp=!0,n},IndependenceNominator.prototype.Identifier=function(n){return IndependenceNominator.__super__.Identifier.call(this,n),n.__independent=!0,n.__hasThisExp=!1,n},IndependenceNominator.prototype.MemberExpression=function(n){var t;return IndependenceNominator.__super__.MemberExpression.call(this,n),n.__hasThisExp=(t=n.object)!=null?t.__hasThisExp:void 0,n.__hasThisExp&&(n.__independent=!1,n!=null&&(n.property.__independent=!1)),n},IndependenceNominator.prototype.CallExpression=function(n){return IndependenceNominator.__super__.CallExpression.call(this,n),n.__hasThisExp=n.callee.__hasThisExp,n},IndependenceNominator.prototype.ObjectExpression=function(n){var u,t,i,r,o,s,f,e;for(IndependenceNominator.__super__.ObjectExpression.call(this,n),f=n.properties,i=0,o=f.length;i<o;i++)t=f[i],t.key.__independent=!1;for(u=!0,e=n.properties,r=0,s=e.length;r<s;r++)t=e[r],u&=t.value.__independent;return n.__independent=u?!0:!1,n},IndependenceNominator.prototype.visit=function(n){var r,f,e,o,t,u,s;if(IndependenceNominator.__super__.visit.call(this,n),!Object.prototype.hasOwnProperty.call(n,"__independent")){r=!0,f=function(n){var r;return i.isObject(n)?(r=t.__independent)!=null?r:!1:!0};for(e in n)if(t=n[e],i.isArray(t))for(u=0,s=t.length;u<s;u++)o=t[u],r&=f(o);else i.isObject(t)&&(r&=f(t));n.__independent=r?!0:!1}return n},IndependenceNominator}(t.JavaScriptVisitor)}).call(this)},t.Query=function(n){(function(){var u,f,i,e,t,r=[].slice;t=require("./Utilities"),i=require("./QueryNodes"),u=require("./JavaScript").JavaScript,n.Query=e=function(){function Query(n,f){var p,c,a,e,s,l,h,v,w,y,o;if(!n||!t.isString(n))throw"Expected the name of a table!";w=n,p=f,c=null,l=null,h=[],s={},e=[],v=null,y=null,a=!1,o=0,this.getComponents=function(){return{filters:c,selections:h,projection:l,ordering:s,orderClauses:e,skip:v,take:y,table:w,context:p,includeTotalCount:a,version:o}},this.setComponents=function(n){var u,f,i,t,b,k,d,g,nt,tt,it,rt,ut,ft,et,r;if(o++,c=(k=n!=null?n.filters:void 0)!=null?k:null,h=(d=n!=null?n.selections:void 0)!=null?d:[],l=(nt=n!=null?n.projection:void 0)!=null?nt:null,v=(tt=n!=null?n.skip:void 0)!=null?tt:null,y=(it=n!=null?n.take:void 0)!=null?it:null,a=(rt=n!=null?n.includeTotalCount:void 0)!=null?rt:!1,w=(ut=n!=null?n.table:void 0)!=null?ut:null,p=(ft=n!=null?n.context:void 0)!=null?ft:null,n!=null?n.orderClauses:void 0)for(e=(et=n!=null?n.orderClauses:void 0)!=null?et:[],s={},t=0,b=e.length;t<b;t++)r=e[t],f=r.name,u=r.ascending,s[f]=u;else{s=(g=n!=null?n.ordering:void 0)!=null?g:{},e=[];for(i in s)e.push({name:i,ascending:!!s[i]})}return this},this.where=function(){var f,n,e,s,h;return n=arguments[0],f=2<=arguments.length?r.call(arguments,1):[],o++,e=function(){if(t.isFunction(n))return u.transformConstraint(n,f);if(t.isObject(n))return i.QueryExpression.groupClauses(i.BinaryOperators.And,function(){var t=[];for(s in n)h=n[s],t.push(e=new i.BinaryExpression(i.BinaryOperators.Equal,new i.MemberExpression(s),new i.ConstantExpression(h)));return t}());if(t.isString(n))return new i.LiteralExpression(n,f);throw"Expected a function, object, or string, not "+n;}(),c=i.QueryExpression.groupClauses(i.BinaryOperators.And,[c,e]),this},this.select=function(){var i,e,n,f,s;if(n=arguments[0],e=2<=arguments.length?r.call(arguments,1):[],o++,t.isString(n))for(h.push(n),f=0,s=e.length;f<s;f++){if(i=e[f],!t.isString(i))throw"Expected string parameters, not "+i;h.push(i)}else if(t.isFunction(n))l=n,h=u.getProjectedFields(l);else throw"Expected a string or a function, not "+n;return this},this.orderBy=function(){var f,n,h,c,i,u,l,a;for(h=1<=arguments.length?r.call(arguments,0):[],o++,i=0,l=h.length;i<l;i++){if(n=h[i],!t.isString(n))throw"Expected string parameters, not "+n;for(s[n]=!0,c=!1,u=0,a=e.length;u<a;u++)f=e[u],f.name===n&&(c=!0,f.ascending=!0);c||e.push({name:n,ascending:!0})}return this},this.orderByDescending=function(){var f,n,h,c,i,u,l,a;for(h=1<=arguments.length?r.call(arguments,0):[],o++,i=0,l=h.length;i<l;i++){if(n=h[i],!t.isString(n))throw"Expected string parameters, not "+n;for(s[n]=!1,c=!1,u=0,a=e.length;u<a;u++)f=e[u],f.name===n&&(c=!0,f.ascending=!1);c||e.push({name:n,ascending:!1})}return this},this.skip=function(n){if(o++,!t.isNumber(n))throw"Expected a number, not "+n;return v=n,this},this.take=function(n){if(o++,!t.isNumber(n))throw"Expected a number, not "+n;return y=n,this},this.includeTotalCount=function(){return o++,a=!0,this}}return Query.registerProvider=function(n,t){return Query.Providers[n]=t,Query.prototype["to"+n]=function(){if(t!=null)return typeof t.toQuery=="function"?t.toQuery(this):void 0}},Query.Providers={},Query.Expressions=i,Query}(),f=require("./ODataProvider").ODataProvider,e.registerProvider("OData",new f)}).call(this)},t.QueryNodes=function(n){(function(){var f,s,h,c,l,e,i,r,a,o,u,v={}.hasOwnProperty,t=function(n,t){function ctor(){this.constructor=n}for(var i in t)v.call(t,i)&&(n[i]=t[i]);return ctor.prototype=t.prototype,n.prototype=new ctor,n.__super__=t.prototype,n};u=require("./Node"),e=u.Node,o=u.Visitor,n.QueryExpression=i=function(n){function QueryExpression(){QueryExpression.__super__.constructor.call(this)}return t(QueryExpression,n),QueryExpression.groupClauses=function(n,t){var i;return i=function(t,i){return t?i?new f(n,t,i):t:i},t.reduce(i,null)},QueryExpression}(e),n.QueryExpressionVisitor=r=function(n){function QueryExpressionVisitor(){QueryExpressionVisitor.__super__.constructor.call(this)}return t(QueryExpressionVisitor,n),QueryExpressionVisitor.prototype.QueryExpression=function(n){return n},QueryExpressionVisitor}(o),n.ConstantExpression=s=function(n){function ConstantExpression(n){this.value=n,ConstantExpression.__super__.constructor.call(this)}return t(ConstantExpression,n),ConstantExpression}(i),r.prototype.ConstantExpression=function(n){return this.QueryExpression(n)},n.MemberExpression=l=function(n){function MemberExpression(n){this.member=n,MemberExpression.__super__.constructor.call(this)}return t(MemberExpression,n),MemberExpression}(i),r.prototype.MemberExpression=function(n){return this.QueryExpression(n)},n.BinaryExpression=f=function(n){function BinaryExpression(n,t,i){this.operator=n,this.left=t,this.right=i,BinaryExpression.__super__.constructor.call(this)}return t(BinaryExpression,n),BinaryExpression}(i),r.prototype.BinaryExpression=function(n){return n=this.QueryExpression(n),n.left=this.visit(n.left),n.right=this.visit(n.right),n},n.BinaryOperators={And:"And",Or:"Or",Add:"Add",Subtract:"Subtract",Multiply:"Multiply",Divide:"Divide",Modulo:"Modulo",GreaterThan:"GreaterThan",GreaterThanOrEqual:"GreaterThanOrEqual",LessThan:"LessThan",LessThanOrEqual:"LessThanOrEqual",NotEqual:"NotEqual",Equal:"Equal"},n.UnaryExpression=a=function(n){function UnaryExpression(n,t){this.operator=n,this.operand=t,UnaryExpression.__super__.constructor.call(this)}return t(UnaryExpression,n),UnaryExpression}(i),r.prototype.UnaryExpression=function(n){return n=this.QueryExpression(n),n.operand=this.visit(n.operand),n},n.UnaryOperators={Not:"Not",Negate:"Negate",Increment:"Increment",Decrement:"Decrement"},n.InvocationExpression=h=function(n){function InvocationExpression(n,t){this.method=n,this.args=t,InvocationExpression.__super__.constructor.call(this)}return t(InvocationExpression,n),InvocationExpression}(i),r.prototype.InvocationExpression=function(n){return n=this.QueryExpression(n),n.args=this.visit(n.args),n},n.Methods={Length:"Length",ToUpperCase:"ToUpperCase",ToLowerCase:"ToLowerCase",Trim:"Trim",IndexOf:"IndexOf",Replace:"Replace",Substring:"Substring",Concat:"Concat",Day:"Day",Month:"Month",Year:"Year",Floor:"Floor",Ceiling:"Ceiling",Round:"Round"},n.LiteralExpression=c=function(n){function LiteralExpression(n,t){this.queryString=n,this.args=t!=null?t:[],LiteralExpression.__super__.constructor.call(this)}return t(LiteralExpression,n),LiteralExpression}(i),r.prototype.LiteralExpression=function(n){return this.QueryExpression(n)}}).call(this)},t.Utilities=function(n){(function(){var t,i=[].slice;t=function(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()},Array.prototype.reduce==null&&(Array.prototype.reduce=function(){var u,n,f,t,r,e;if(u=arguments[0],e=2<=arguments.length?i.call(arguments,1):[],n=this,f=n.length,t=0,r=void 0,n==null)throw new TypeError("Object is null or undefined");if(typeof u!="function")throw new TypeError("First argument is not callable");if(e.length===0)if(f===0)throw new TypeError("Array length is 0 and no second argument");else r=n[0],t=1;else r=e[0];while(t<f)t in n&&(r=u.call(void 0,r,n[t],n)),++t;return r}),Array.prototype.map==null&&(Array.prototype.map=function(n,t){var e,i,r,o,u,f,s;if(typeof this=="undefined"||this===null)throw new TypeError("this is null or not defined");if(typeof n!="function")throw new TypeError(n+" is not a function");for(t=t?t:void 0,r=Object(this),o=r.length>>>0,u=new Array(o),i=f=0,s=r.length;f<s;i=++f)e=r[i],i in r&&(u[i]=n.call(t,e,i,r));return u}),Array.isArray==null&&(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"}),n.isObject=function(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()==="object"},n.isString=function(n){return typeof n=="string"},n.isFunction=function(n){return typeof n=="function"},n.isArray=Array.isArray,n.isNumber=function(n){return typeof n=="number"},n.isBoolean=function(n){return typeof n=="boolean"},n.isDate=function(n){return t(n)==="date"},n.functionName=function(n){var r,t,i;return typeof Function.prototype.name=="function"?Function.prototype.name.call(n):(i=n.toString(),t="function ",i.slice(0,+(t.length-1)+1||9e9)===t&&(r=i.indexOf("(",t.length),r>t.length))?i.slice(t.length,+(r-1)+1||9e9):null}}).call(this)},t.esprima=function(n){(function(t,i){"use strict";typeof define=="function"&&define.amd?define(["exports"],i):typeof n!="undefined"?i(n):i(t.esprima={})})(this,function(n){"use strict";function assert(n,t){if(!n)throw new Error("ASSERT: "+t);}function isDecimalDigit(n){return n>=48&&n<=57}function isHexDigit(n){return"0123456789abcdefABCDEF".indexOf(n)>=0}function isOctalDigit(n){return"01234567".indexOf(n)>=0}function isWhiteSpace(n){return n===32||n===9||n===11||n===12||n===160||n>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(n)>=0}function isLineTerminator(n){return n===10||n===13||n===8232||n===8233}function isIdentifierStart(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n===92||n>=128&&w.NonAsciiIdentifierStart.test(String.fromCharCode(n))}function isIdentifierPart(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57||n===92||n>=128&&w.NonAsciiIdentifierPart.test(String.fromCharCode(n))}function isFutureReservedWord(n){switch(n){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function isStrictModeReservedWord(n){switch(n){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function isRestrictedWord(n){return n==="eval"||n==="arguments"}function isKeyword(n){if(l&&isStrictModeReservedWord(n))return!0;switch(n.length){case 2:return n==="if"||n==="in"||n==="do";case 3:return n==="var"||n==="for"||n==="new"||n==="try"||n==="let";case 4:return n==="this"||n==="else"||n==="case"||n==="void"||n==="with"||n==="enum";case 5:return n==="while"||n==="break"||n==="catch"||n==="throw"||n==="const"||n==="yield"||n==="class"||n==="super";case 6:return n==="return"||n==="typeof"||n==="delete"||n==="switch"||n==="export"||n==="import";case 7:return n==="default"||n==="finally"||n==="extends";case 8:return n==="function"||n==="continue"||n==="debugger";case 10:return n==="instanceof";default:return!1}}function addComment(n,t,r,u,f){var e;(assert(typeof r=="number","Comment must have valid position"),o.lastCommentStart>=r)||(o.lastCommentStart=r,e={type:n,value:t},i.range&&(e.range=[r,u]),i.loc&&(e.loc=f),i.comments.push(e),i.attachComment&&(i.leadingComments.push(e),i.trailingComments.push(e)))}function skipSingleLineComment(n){for(var o,e,u=t-n,f={start:{line:h,column:t-c-n}};t<a;)if(o=r.charCodeAt(t),++t,isLineTerminator(o)){i.comments&&(e=r.slice(u+n,t-1),f.end={line:h,column:t-c-1},addComment("Line",e,u,t-1,f)),o===13&&r.charCodeAt(t)===10&&++t,++h,c=t;return}i.comments&&(e=r.slice(u+n,t),f.end={line:h,column:t-c},addComment("Line",e,u,t,f))}function skipMultiLineComment(){var u,e,n,o;for(i.comments&&(u=t-2,e={start:{line:h,column:t-c-2}});t<a;)if(n=r.charCodeAt(t),isLineTerminator(n))n===13&&r.charCodeAt(t+1)===10&&++t,++h,++t,c=t,t>=a&&throwError({},f.UnexpectedToken,"ILLEGAL");else if(n===42){if(r.charCodeAt(t+1)===47){++t,++t,i.comments&&(o=r.slice(u+2,t-2),e.end={line:h,column:t-c},addComment("Block",o,u,t,e));return}++t}else++t;throwError({},f.UnexpectedToken,"ILLEGAL")}function skipComment(){for(var n,i=t===0;t<a;)if(n=r.charCodeAt(t),isWhiteSpace(n))++t;else if(isLineTerminator(n))++t,n===13&&r.charCodeAt(t)===10&&++t,++h,c=t,i=!0;else if(n===47)if(n=r.charCodeAt(t+1),n===47)++t,++t,skipSingleLineComment(2),i=!0;else if(n===42)++t,++t,skipMultiLineComment();else break;else if(i&&n===45)if(r.charCodeAt(t+1)===45&&r.charCodeAt(t+2)===62)t+=3,skipSingleLineComment(3);else break;else if(n===60)if(r.slice(t+1,t+4)==="!--")++t,++t,++t,++t,skipSingleLineComment(4);else break;else break}function scanHexEscape(n){for(var e,u=0,f=n==="u"?4:2,i=0;i<f;++i)if(t<a&&isHexDigit(r[t]))e=r[t++],u=u*16+"0123456789abcdef".indexOf(e.toLowerCase());else return"";return String.fromCharCode(u)}function scanUnicodeCodePointEscape(){var i,n,u,e;for(i=r[t],n=0,i==="}"&&throwError({},f.UnexpectedToken,"ILLEGAL");t<a;){if(i=r[t++],!isHexDigit(i))break;n=n*16+"0123456789abcdef".indexOf(i.toLowerCase())}return((n>1114111||i!=="}")&&throwError({},f.UnexpectedToken,"ILLEGAL"),n<=65535)?String.fromCharCode(n):(u=(n-65536>>10)+55296,e=(n-65536&1023)+56320,String.fromCharCode(u,e))}function getEscapedIdentifier(){var n,i;for(n=r.charCodeAt(t++),i=String.fromCharCode(n),n===92&&(r.charCodeAt(t)!==117&&throwError({},f.UnexpectedToken,"ILLEGAL"),++t,n=scanHexEscape("u"),n&&n!=="\\"&&isIdentifierStart(n.charCodeAt(0))||throwError({},f.UnexpectedToken,"ILLEGAL"),i=n);t<a;){if(n=r.charCodeAt(t),!isIdentifierPart(n))break;++t,i+=String.fromCharCode(n),n===92&&(i=i.substr(0,i.length-1),r.charCodeAt(t)!==117&&throwError({},f.UnexpectedToken,"ILLEGAL"),++t,n=scanHexEscape("u"),n&&n!=="\\"&&isIdentifierPart(n.charCodeAt(0))||throwError({},f.UnexpectedToken,"ILLEGAL"),i+=n)}return i}function getIdentifier(){for(var i,n=t++;t<a;){if(i=r.charCodeAt(t),i===92)return t=n,getEscapedIdentifier();if(isIdentifierPart(i))++t;else break}return r.slice(n,t)}function scanIdentifier(){var i,n,f;return i=t,n=r.charCodeAt(t)===92?getEscapedIdentifier():getIdentifier(),f=n.length===1?u.Identifier:isKeyword(n)?u.Keyword:n==="null"?u.NullLiteral:n==="true"||n==="false"?u.BooleanLiteral:u.Identifier,{type:f,value:n,lineNumber:h,lineStart:c,start:i,end:t}}function scanPunctuator(){var n=t,e=r.charCodeAt(t),v,s=r[t],l,o,a;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++t,i.tokenize&&(e===40?i.openParenToken=i.tokens.length:e===123&&(i.openCurlyToken=i.tokens.length)),{type:u.Punctuator,value:String.fromCharCode(e),lineNumber:h,lineStart:c,start:n,end:t};default:if(v=r.charCodeAt(t+1),v===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return t+=2,{type:u.Punctuator,value:String.fromCharCode(e)+String.fromCharCode(v),lineNumber:h,lineStart:c,start:n,end:t};case 33:case 61:return t+=2,r.charCodeAt(t)===61&&++t,{type:u.Punctuator,value:r.slice(n,t),lineNumber:h,lineStart:c,start:n,end:t}}}if(a=r.substr(t,4),a===">>>=")return t+=4,{type:u.Punctuator,value:a,lineNumber:h,lineStart:c,start:n,end:t};if(o=a.substr(0,3),o===">>>"||o==="<<="||o===">>=")return t+=3,{type:u.Punctuator,value:o,lineNumber:h,lineStart:c,start:n,end:t};if(l=o.substr(0,2),s===l[1]&&"+-<>&|".indexOf(s)>=0||l==="=>")return t+=2,{type:u.Punctuator,value:l,lineNumber:h,lineStart:c,start:n,end:t};if("<>=!+-*%&|^/".indexOf(s)>=0)return++t,{type:u.Punctuator,value:s,lineNumber:h,lineStart:c,start:n,end:t};throwError({},f.UnexpectedToken,"ILLEGAL")}function scanHexLiteral(n){for(var i="";t<a;){if(!isHexDigit(r[t]))break;i+=r[t++]}return i.length===0&&throwError({},f.UnexpectedToken,"ILLEGAL"),isIdentifierStart(r.charCodeAt(t))&&throwError({},f.UnexpectedToken,"ILLEGAL"),{type:u.NumericLiteral,value:parseInt("0x"+i,16),lineNumber:h,lineStart:c,start:n,end:t}}function scanOctalLiteral(n){for(var i="0"+r[t++];t<a;){if(!isOctalDigit(r[t]))break;i+=r[t++]}return(isIdentifierStart(r.charCodeAt(t))||isDecimalDigit(r.charCodeAt(t)))&&throwError({},f.UnexpectedToken,"ILLEGAL"),{type:u.NumericLiteral,value:parseInt(i,8),octal:!0,lineNumber:h,lineStart:c,start:n,end:t}}function scanNumericLiteral(){var i,e,n;if(n=r[t],assert(isDecimalDigit(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=t,i="",n!=="."){if(i=r[t++],n=r[t],i==="0"){if(n==="x"||n==="X")return++t,scanHexLiteral(e);if(isOctalDigit(n))return scanOctalLiteral(e);n&&isDecimalDigit(n.charCodeAt(0))&&throwError({},f.UnexpectedToken,"ILLEGAL")}while(isDecimalDigit(r.charCodeAt(t)))i+=r[t++];n=r[t]}if(n==="."){for(i+=r[t++];isDecimalDigit(r.charCodeAt(t));)i+=r[t++];n=r[t]}if(n==="e"||n==="E")if(i+=r[t++],n=r[t],(n==="+"||n==="-")&&(i+=r[t++]),isDecimalDigit(r.charCodeAt(t)))while(isDecimalDigit(r.charCodeAt(t)))i+=r[t++];else throwError({},f.UnexpectedToken,"ILLEGAL");return isIdentifierStart(r.charCodeAt(t))&&throwError({},f.UnexpectedToken,"ILLEGAL"),{type:u.NumericLiteral,value:parseFloat(i),lineNumber:h,lineStart:c,start:e,end:t}}function scanStringLiteral(){var i="",o,v,n,e,s,y,l=!1,p,w;for(p=h,w=c,o=r[t],assert(o==="'"||o==='"',"String literal must starts with a quote"),v=t,++t;t<a;)if(n=r[t++],n===o){o="";break}else if(n==="\\")if(n=r[t++],n&&isLineTerminator(n.charCodeAt(0)))++h,n==="\r"&&r[t]==="\n"&&++t,c=t;else switch(n){case"u":case"x":r[t]==="{"?(++t,i+=scanUnicodeCodePointEscape()):(y=t,s=scanHexEscape(n),s?i+=s:(t=y,i+=n));break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\x0b";break;default:isOctalDigit(n)?(e="01234567".indexOf(n),e!==0&&(l=!0),t<a&&isOctalDigit(r[t])&&(l=!0,e=e*8+"01234567".indexOf(r[t++]),"0123".indexOf(n)>=0&&t<a&&isOctalDigit(r[t])&&(e=e*8+"01234567".indexOf(r[t++]))),i+=String.fromCharCode(e)):i+=n}else if(isLineTerminator(n.charCodeAt(0)))break;else i+=n;return o!==""&&throwError({},f.UnexpectedToken,"ILLEGAL"),{type:u.StringLiteral,value:i,octal:l,startLineNumber:p,startLineStart:w,lineNumber:h,lineStart:c,start:v,end:t}}function testRegExp(n,t){var i;try{i=new RegExp(n,t)}catch(r){throwError({},f.InvalidRegExp)}return i}function scanRegExpBody(){var n,i,u,e,o;for(n=r[t],assert(n==="/","Regular expression literal must start with a slash"),i=r[t++],u=!1,e=!1;t<a;)if(n=r[t++],i+=n,n==="\\")n=r[t++],isLineTerminator(n.charCodeAt(0))&&throwError({},f.UnterminatedRegExp),i+=n;else if(isLineTerminator(n.charCodeAt(0)))throwError({},f.UnterminatedRegExp);else if(u)n==="]"&&(u=!1);else if(n==="/"){e=!0;break}else n==="["&&(u=!0);return e||throwError({},f.UnterminatedRegExp),o=i.substr(1,i.length-2),{value:o,literal:i}}function scanRegExpFlags(){for(var n,e,i="",u="";t<a;){if(n=r[t],!isIdentifierPart(n.charCodeAt(0)))break;if(++t,n==="\\"&&t<a)if(n=r[t],n==="u"){if(++t,e=t,n=scanHexEscape("u"),n)for(u+=n,i+="\\u";e<t;++e)i+=r[e];else t=e,u+="u",i+="\\u";throwErrorTolerant({},f.UnexpectedToken,"ILLEGAL")}else i+="\\",throwErrorTolerant({},f.UnexpectedToken,"ILLEGAL");else u+=n,i+=n}return{value:u,literal:i}}function scanRegExp(){var n,r,f,o;return(e=null,skipComment(),n=t,r=scanRegExpBody(),f=scanRegExpFlags(),o=testRegExp(r.value,f.value),i.tokenize)?{type:u.RegularExpression,value:o,lineNumber:h,lineStart:c,start:n,end:t}:{literal:r.literal+f.literal,value:o,start:n,end:t}}function collectRegex(){var r,u,f,n;return skipComment(),r=t,u={start:{line:h,column:t-c}},f=scanRegExp(),u.end={line:h,column:t-c},i.tokenize||(i.tokens.length>0&&(n=i.tokens[i.tokens.length-1],n.range[0]===r&&n.type==="Punctuator"&&(n.value==="/"||n.value==="/=")&&i.tokens.pop()),i.tokens.push({type:"RegularExpression",value:f.literal,range:[r,t],loc:u})),f}function isIdentifierName(n){return n.type===u.Identifier||n.type===u.Keyword||n.type===u.BooleanLiteral||n.type===u.NullLiteral}function advanceSlash(){var t,n;if(t=i.tokens[i.tokens.length-1],!t)return collectRegex();if(t.type==="Punctuator"){if(t.value==="]")return scanPunctuator();if(t.value===")")return(n=i.tokens[i.openParenToken-1],n&&n.type==="Keyword"&&(n.value==="if"||n.value==="while"||n.value==="for"||n.value==="with"))?collectRegex():scanPunctuator();if(t.value==="}"){if(i.tokens[i.openCurlyToken-3]&&i.tokens[i.openCurlyToken-3].type==="Keyword"){if(n=i.tokens[i.openCurlyToken-4],!n)return scanPunctuator()}else if(i.tokens[i.openCurlyToken-4]&&i.tokens[i.openCurlyToken-4].type==="Keyword"){if(n=i.tokens[i.openCurlyToken-5],!n)return collectRegex()}else return scanPunctuator();return b.indexOf(n.value)>=0?scanPunctuator():collectRegex()}return collectRegex()}return t.type==="Keyword"?collectRegex():scanPunctuator()}function advance(){var n;return(skipComment(),t>=a)?{type:u.EOF,lineNumber:h,lineStart:c,start:t,end:t}:(n=r.charCodeAt(t),isIdentifierStart(n))?scanIdentifier():n===40||n===41||n===59?scanPunctuator():n===39||n===34?scanStringLiteral():n===46?isDecimalDigit(r.charCodeAt(t+1))?scanNumericLiteral():scanPunctuator():isDecimalDigit(n)?scanNumericLiteral():i.tokenize&&n===47?advanceSlash():scanPunctuator()}function collectToken(){var f,n,e;return skipComment(),f={start:{line:h,column:t-c}},n=advance(),f.end={line:h,column:t-c},n.type!==u.EOF&&(e=r.slice(n.start,n.end),i.tokens.push({type:v[n.type],value:e,range:[n.start,n.end],loc:f})),n}function lex(){var n;return n=e,t=n.end,h=n.lineNumber,c=n.lineStart,e=typeof i.tokens!="undefined"?collectToken():advance(),t=n.end,h=n.lineNumber,c=n.lineStart,n}function peek(){var n,r,u;n=t,r=h,u=c,e=typeof i.tokens!="undefined"?collectToken():advance(),t=n,h=r,c=u}function Position(){this.line=h,this.column=t-c}function SourceLocation(){this.start=new Position,this.end=null}function WrappingSourceLocation(n){this.start=n.type===u.StringLiteral?{line:n.startLineNumber,column:n.start-n.startLineStart}:{line:n.lineNumber,column:n.start-n.lineStart},this.end=null}function Node(){t=e.start,e.type===u.StringLiteral?(h=e.startLineNumber,c=e.startLineStart):(h=e.lineNumber,c=e.lineStart),i.range&&(this.range=[t,0]),i.loc&&(this.loc=new SourceLocation)}function WrappingNode(n){i.range&&(this.range=[n.start,0]),i.loc&&(this.loc=new WrappingSourceLocation(n))}function peekLineTerminator(){var i,n,r,u;return i=t,n=h,r=c,skipComment(),u=h!==n,t=i,h=n,c=r,u}function throwError(n,i){var r,f=Array.prototype.slice.call(arguments,2),u=i.replace(/%(\d)/g,function(n,t){return assert(t<f.length,"Message reference must be in range"),f[t]});typeof n.lineNumber=="number"?(r=new Error("Line "+n.lineNumber+": "+u),r.index=n.start,r.lineNumber=n.lineNumber,r.column=n.start-c+1):(r=new Error("Line "+h+": "+u),r.index=t,r.lineNumber=h,r.column=t-c+1),r.description=u;throw r;}function throwErrorTolerant(){try{throwError.apply(null,arguments)}catch(n){if(i.errors)i.errors.push(n);else throw n;}}function throwUnexpected(n){if(n.type===u.EOF&&throwError(n,f.UnexpectedEOS),n.type===u.NumericLiteral&&throwError(n,f.UnexpectedNumber),n.type===u.StringLiteral&&throwError(n,f.UnexpectedString),n.type===u.Identifier&&throwError(n,f.UnexpectedIdentifier),n.type===u.Keyword){if(isFutureReservedWord(n.value))throwError(n,f.UnexpectedReserved);else if(l&&isStrictModeReservedWord(n.value)){throwErrorTolerant(n,f.StrictReservedWord);return}throwError(n,f.UnexpectedToken,n.value)}throwError(n,f.UnexpectedToken,n.value)}function expect(n){var t=lex();(t.type!==u.Punctuator||t.value!==n)&&throwUnexpected(t)}function expectTolerant(n){if(i.errors){var t=e;t.type!==u.Punctuator&&t.value!==n?throwErrorTolerant(t,f.UnexpectedToken,t.value):lex()}else expect(n)}function expectKeyword(n){var t=lex();(t.type!==u.Keyword||t.value!==n)&&throwUnexpected(t)}function match(n){return e.type===u.Punctuator&&e.value===n}function matchKeyword(n){return e.type===u.Keyword&&e.value===n}function matchAssign(){var n;return e.type!==u.Punctuator?!1:(n=e.value,n==="="||n==="*="||n==="/="||n==="%="||n==="+="||n==="-="||n==="<<="||n===">>="||n===">>>="||n==="&="||n==="^="||n==="|=")}function consumeSemicolon(){var n;if(r.charCodeAt(t)===59||match(";")){lex();return}(n=h,skipComment(),h===n)&&(e.type===u.EOF||match("}")||throwUnexpected(e))}function isLeftHandSide(n){return n.type===s.Identifier||n.type===s.MemberExpression}function parseArrayInitialiser(){var n=[],t=new Node;for(expect("[");!match("]");)match(",")?(lex(),n.push(null)):(n.push(parseAssignmentExpression()),match("]")||expect(","));return lex(),t.finishArrayExpression(n)}function parsePropertyFunction(n,t){var i,r,u=new Node;return i=l,r=parseFunctionSourceElements(),t&&l&&isRestrictedWord(n[0].name)&&throwErrorTolerant(t,f.StrictParamName),l=i,u.finishFunctionExpression(null,n,[],r)}function parseObjectPropertyKey(){var n,t=new Node;return(n=lex(),n.type===u.StringLiteral||n.type===u.NumericLiteral)?(l&&n.octal&&throwErrorTolerant(n,f.StrictOctalLiteral),t.finishLiteral(n)):t.finishIdentifier(n.value)}function parseObjectProperty(){var n,i,o,t,s,r=new Node;if(n=e,n.type===u.Identifier)return(o=parseObjectPropertyKey(),n.value==="get"&&!match(":"))?(i=parseObjectPropertyKey(),expect("("),expect(")"),t=parsePropertyFunction([]),r.finishProperty("get",i,t)):n.value==="set"&&!match(":")?(i=parseObjectPropertyKey(),expect("("),n=e,n.type!==u.Identifier?(expect(")"),throwErrorTolerant(n,f.UnexpectedToken,n.value),t=parsePropertyFunction([])):(s=[parseVariableIdentifier()],expect(")"),t=parsePropertyFunction(s,n)),r.finishProperty("set",i,t)):(expect(":"),t=parseAssignmentExpression(),r.finishProperty("init",o,t));if(n.type===u.EOF||n.type===u.Punctuator)throwUnexpected(n);else return i=parseObjectPropertyKey(),expect(":"),t=parseAssignmentExpression(),r.finishProperty("init",i,t)}function parseObjectInitialiser(){var u=[],n,e,i,t,r={},o=String,h=new Node;for(expect("{");!match("}");)n=parseObjectProperty(),e=n.key.type===s.Identifier?n.key.name:o(n.key.value),t=n.kind==="init"?y.Data:n.kind==="get"?y.Get:y.Set,i="$"+e,Object.prototype.hasOwnProperty.call(r,i)?(r[i]===y.Data?l&&t===y.Data?throwErrorTolerant({},f.StrictDuplicateProperty):t!==y.Data&&throwErrorTolerant({},f.AccessorDataProperty):t===y.Data?throwErrorTolerant({},f.AccessorDataProperty):r[i]&t&&throwErrorTolerant({},f.AccessorGetSet),r[i]|=t):r[i]=t,u.push(n),match("}")||expectTolerant(",");return expect("}"),h.finishObjectExpression(u)}function parseGroupExpression(){var n;return(expect("("),match(")"))?(lex(),p.ArrowParameterPlaceHolder):(++o.parenthesisCount,n=parseExpression(),expect(")"),n)}function parsePrimaryExpression(){var t,r,o,n;if(match("("))return parseGroupExpression();if(match("["))return parseArrayInitialiser();if(match("{"))return parseObjectInitialiser();if(t=e.type,n=new Node,t===u.Identifier)o=n.finishIdentifier(lex().value);else if(t===u.StringLiteral||t===u.NumericLiteral)l&&e.octal&&throwErrorTolerant(e,f.StrictOctalLiteral),o=n.finishLiteral(lex());else if(t===u.Keyword){if(matchKeyword("function"))return parseFunctionExpression();matchKeyword("this")?(lex(),o=n.finishThisExpression()):throwUnexpected(lex())}else t===u.BooleanLiteral?(r=lex(),r.value=r.value==="true",o=n.finishLiteral(r)):t===u.NullLiteral?(r=lex(),r.value=null,o=n.finishLiteral(r)):match("/")||match("/=")?(o=typeof i.tokens!="undefined"?n.finishLiteral(collectRegex()):n.finishLiteral(scanRegExp()),peek()):throwUnexpected(lex());return o}function parseArguments(){var n=[];if(expect("("),!match(")"))while(t<a){if(n.push(parseAssignmentExpression()),match(")"))break;expectTolerant(",")}return expect(")"),n}function parseNonComputedProperty(){var n,t=new Node;return n=lex(),isIdentifierName(n)||throwUnexpected(n),t.finishIdentifier(n.value)}function parseNonComputedMember(){return expect("."),parseNonComputedProperty()}function parseComputedMember(){var n;return expect("["),n=parseExpression(),expect("]"),n}function parseNewExpression(){var n,t,i=new Node;return expectKeyword("new"),n=parseLeftHandSideExpression(),t=match("(")?parseArguments():[],i.finishNewExpression(n,t)}function parseLeftHandSideExpressionAllowCall(){var n,r,t,i,u=o.allowIn;for(i=e,o.allowIn=!0,n=matchKeyword("new")?parseNewExpression():parsePrimaryExpression();;)if(match("."))t=parseNonComputedMember(),n=new WrappingNode(i).finishMemberExpression(".",n,t);else if(match("("))r=parseArguments(),n=new WrappingNode(i).finishCallExpression(n,r);else if(match("["))t=parseComputedMember(),n=new WrappingNode(i).finishMemberExpression("[",n,t);else break;return o.allowIn=u,n}function parseLeftHandSideExpression(){var n,t,i;for(assert(o.allowIn,"callee of new expression always allow in keyword."),i=e,n=matchKeyword("new")?parseNewExpression():parsePrimaryExpression();;)if(match("["))t=parseComputedMember(),n=new WrappingNode(i).finishMemberExpression("[",n,t);else if(match("."))t=parseNonComputedMember(),n=new WrappingNode(i).finishMemberExpression(".",n,t);else break;return n}function parsePostfixExpression(){var n,t,i=e;return n=parseLeftHandSideExpressionAllowCall(),e.type===u.Punctuator&&(match("++")||match("--"))&&!peekLineTerminator()&&(l&&n.type===s.Identifier&&isRestrictedWord(n.name)&&throwErrorTolerant({},f.StrictLHSPostfix),isLeftHandSide(n)||throwErrorTolerant({},f.InvalidLHSInAssignment),t=lex(),n=new WrappingNode(i).finishPostfixExpression(t.value,n)),n}function parseUnaryExpression(){var t,n,i;return e.type!==u.Punctuator&&e.type!==u.Keyword?n=parsePostfixExpression():match("++")||match("--")?(i=e,t=lex(),n=parseUnaryExpression(),l&&n.type===s.Identifier&&isRestrictedWord(n.name)&&throwErrorTolerant({},f.StrictLHSPrefix),isLeftHandSide(n)||throwErrorTolerant({},f.InvalidLHSInAssignment),n=new WrappingNode(i).finishUnaryExpression(t.value,n)):match("+")||match("-")||match("~")||match("!")?(i=e,t=lex(),n=parseUnaryExpression(),n=new WrappingNode(i).finishUnaryExpression(t.value,n)):matchKeyword("delete")||matchKeyword("void")||matchKeyword("typeof")?(i=e,t=lex(),n=parseUnaryExpression(),n=new WrappingNode(i).finishUnaryExpression(t.value,n),l&&n.operator==="delete"&&n.argument.type===s.Identifier&&throwErrorTolerant({},f.StrictDelete)):n=parsePostfixExpression(),n}function binaryPrecedence(n,t){var i=0;if(n.type!==u.Punctuator&&n.type!==u.Keyword)return 0;switch(n.value){case"||":i=1;break;case"&&":i=2;break;case"|":i=3;break;case"^":i=4;break;case"&":i=5;break;case"==":case"!=":case"===":case"!==":i=6;break;case"<":case">":case"<=":case">=":case"instanceof":i=7;break;case"in":i=t?7:0;break;case"<<":case">>":case">>>":i=8;break;case"+":case"-":i=9;break;case"*":case"/":case"%":i=11}return i}function parseBinaryExpression(){var c,i,t,r,u,n,h,l,f,s;if((c=e,f=parseUnaryExpression(),f===p.ArrowParameterPlaceHolder)||(r=e,u=binaryPrecedence(r,o.allowIn),u===0))return f;for(r.prec=u,lex(),i=[c,e],h=parseUnaryExpression(),n=[f,r,h];(u=binaryPrecedence(e,o.allowIn))>0;){while(n.length>2&&u<=n[n.length-2].prec)h=n.pop(),l=n.pop().value,f=n.pop(),i.pop(),t=new WrappingNode(i[i.length-1]).finishBinaryExpression(l,f,h),n.push(t);r=lex(),r.prec=u,n.push(r),i.push(e),t=parseUnaryExpression(),n.push(t)}for(s=n.length-1,t=n[s],i.pop();s>1;)t=new WrappingNode(i.pop()).finishBinaryExpression(n[s-1].value,n[s-2],t),s-=2;return t}function parseConditionalExpression(){var n,t,i,r,u;return(u=e,n=parseBinaryExpression(),n===p.ArrowParameterPlaceHolder)?n:(match("?")&&(lex(),t=o.allowIn,o.allowIn=!0,i=parseAssignmentExpression(),o.allowIn=t,expect(":"),r=parseAssignmentExpression(),n=new WrappingNode(u).finishConditionalExpression(n,i,r)),n)}function parseConciseBody(){return match("{")?parseFunctionSourceElements():parseAssignmentExpression()}function reinterpretAsCoverFormalsList(n){var u,h,t,e,r,o,i,c;for(e=[],r=[],o=0,c=null,i={paramSet:{}},u=0,h=n.length;u<h;u+=1)if(t=n[u],t.type===s.Identifier)e.push(t),r.push(null),validateParam(i,t,t.name);else if(t.type===s.AssignmentExpression)e.push(t.left),r.push(t.right),++o,validateParam(i,t.left,t.left.name);else return null;return i.message===f.StrictParamDupe&&throwError(l?i.stricted:i.firstRestricted,i.message),o===0&&(r=[]),{params:e,defaults:r,rest:c,stricted:i.stricted,firstRestricted:i.firstRestricted,message:i.message}}function parseArrowFunctionExpression(n,t){var r,i;return expect("=>"),r=l,i=parseConciseBody(),l&&n.firstRestricted&&throwError(n.firstRestricted,n.message),l&&n.stricted&&throwErrorTolerant(n.stricted,n.message),l=r,t.finishArrowFunctionExpression(n.params,n.defaults,i,i.type!==s.BlockStatement)}function parseAssignmentExpression(){var r,i,n,h,t,u;return(r=o.parenthesisCount,u=e,i=e,n=parseConditionalExpression(),(n===p.ArrowParameterPlaceHolder||match("=>"))&&(o.parenthesisCount===r||o.parenthesisCount===r+1)&&(n.type===s.Identifier?t=reinterpretAsCoverFormalsList([n]):n.type===s.AssignmentExpression?t=reinterpretAsCoverFormalsList([n]):n.type===s.SequenceExpression?t=reinterpretAsCoverFormalsList(n.expressions):n===p.ArrowParameterPlaceHolder&&(t=reinterpretAsCoverFormalsList([])),t))?parseArrowFunctionExpression(t,new WrappingNode(u)):(matchAssign()&&(isLeftHandSide(n)||throwErrorTolerant({},f.InvalidLHSInAssignment),l&&n.type===s.Identifier&&isRestrictedWord(n.name)&&throwErrorTolerant(i,f.StrictLHSAssignment),i=lex(),h=parseAssignmentExpression(),n=new WrappingNode(u).finishAssignmentExpression(i.value,n,h)),n)}function parseExpression(){var n,r=e,i;if(n=parseAssignmentExpression(),match(",")){for(i=[n];t<a;){if(!match(","))break;lex(),i.push(parseAssignmentExpression())}n=new WrappingNode(r).finishSequenceExpression(i)}return n}function parseStatementList(){for(var i=[],n;t<a;){if(match("}"))break;if(n=parseSourceElement(),typeof n=="undefined")break;i.push(n)}return i}function parseBlock(){var n,t=new Node;return expect("{"),n=parseStatementList(),expect("}"),t.finishBlockStatement(n)}function parseVariableIdentifier(){var n,t=new Node;return n=lex(),n.type!==u.Identifier&&throwUnexpected(n),t.finishIdentifier(n.value)}function parseVariableDeclaration(n){var t=null,i,r=new Node;return i=parseVariableIdentifier(),l&&isRestrictedWord(i.name)&&throwErrorTolerant({},f.StrictVarName),n==="const"?(expect("="),t=parseAssignmentExpression()):match("=")&&(lex(),t=parseAssignmentExpression()),r.finishVariableDeclarator(i,t)}function parseVariableDeclarationList(n){var i=[];do{if(i.push(parseVariableDeclaration(n)),!match(","))break;lex()}while(t<a);return i}function parseVariableStatement(n){var t;return expectKeyword("var"),t=parseVariableDeclarationList(),consumeSemicolon(),n.finishVariableDeclaration(t,"var")}function parseConstLetDeclaration(n){var t,i=new Node;return expectKeyword(n),t=parseVariableDeclarationList(n),consumeSemicolon(),i.finishVariableDeclaration(t,n)}function parseEmptyStatement(){var n=new Node;return expect(";"),n.finishEmptyStatement()}function parseExpressionStatement(n){var t=parseExpression();return consumeSemicolon(),n.finishExpressionStatement(t)}function parseIfStatement(n){var i,r,t;return expectKeyword("if"),expect("("),i=parseExpression(),expect(")"),r=parseStatement(),matchKeyword("else")?(lex(),t=parseStatement()):t=null,n.finishIfStatement(i,r,t)}function parseDoWhileStatement(n){var t,i,r;return expectKeyword("do"),r=o.inIteration,o.inIteration=!0,t=parseStatement(),o.inIteration=r,expectKeyword("while"),expect("("),i=parseExpression(),expect(")"),match(";")&&lex(),n.finishDoWhileStatement(t,i)}function parseWhileStatement(n){var t,i,r;return expectKeyword("while"),expect("("),t=parseExpression(),expect(")"),r=o.inIteration,o.inIteration=!0,i=parseStatement(),o.inIteration=r,n.finishWhileStatement(t,i)}function parseForVariableDeclaration(){var n,t,i=new Node;return n=lex(),t=parseVariableDeclarationList(),i.finishVariableDeclaration(t,n.value)}function parseForStatement(n){var t,r,u,i,e,s,h,c=o.allowIn;return t=r=u=null,expectKeyword("for"),expect("("),match(";")?lex():(matchKeyword("var")||matchKeyword("let")?(o.allowIn=!1,t=parseForVariableDeclaration(),o.allowIn=c,t.declarations.length===1&&matchKeyword("in")&&(lex(),i=t,e=parseExpression(),t=null)):(o.allowIn=!1,t=parseExpression(),o.allowIn=c,matchKeyword("in")&&(isLeftHandSide(t)||throwErrorTolerant({},f.InvalidLHSInForIn),lex(),i=t,e=parseExpression(),t=null)),typeof i=="undefined"&&expect(";")),typeof i=="undefined"&&(match(";")||(r=parseExpression()),expect(";"),match(")")||(u=parseExpression())),expect(")"),h=o.inIteration,o.inIteration=!0,s=parseStatement(),o.inIteration=h,typeof i=="undefined"?n.finishForStatement(t,r,u,s):n.finishForInStatement(i,e,s)}function parseContinueStatement(n){var i=null,s;return(expectKeyword("continue"),r.charCodeAt(t)===59)?(lex(),o.inIteration||throwError({},f.IllegalContinue),n.finishContinueStatement(null)):peekLineTerminator()?(o.inIteration||throwError({},f.IllegalContinue),n.finishContinueStatement(null)):(e.type===u.Identifier&&(i=parseVariableIdentifier(),s="$"+i.name,Object.prototype.hasOwnProperty.call(o.labelSet,s)||throwError({},f.UnknownLabel,i.name)),consumeSemicolon(),i!==null||o.inIteration||throwError({},f.IllegalContinue),n.finishContinueStatement(i))}function parseBreakStatement(n){var i=null,s;return(expectKeyword("break"),r.charCodeAt(t)===59)?(lex(),o.inIteration||o.inSwitch||throwError({},f.IllegalBreak),n.finishBreakStatement(null)):peekLineTerminator()?(o.inIteration||o.inSwitch||throwError({},f.IllegalBreak),n.finishBreakStatement(null)):(e.type===u.Identifier&&(i=parseVariableIdentifier(),s="$"+i.name,Object.prototype.hasOwnProperty.call(o.labelSet,s)||throwError({},f.UnknownLabel,i.name)),consumeSemicolon(),i!==null||o.inIteration||o.inSwitch||throwError({},f.IllegalBreak),n.finishBreakStatement(i))}function parseReturnStatement(n){var i=null;return(expectKeyword("return"),o.inFunctionBody||throwErrorTolerant({},f.IllegalReturn),r.charCodeAt(t)===32&&isIdentifierStart(r.charCodeAt(t+1)))?(i=parseExpression(),consumeSemicolon(),n.finishReturnStatement(i)):peekLineTerminator()?n.finishReturnStatement(null):(match(";")||match("}")||e.type===u.EOF||(i=parseExpression()),consumeSemicolon(),n.finishReturnStatement(i))}function parseWithStatement(n){var t,i;return l&&(skipComment(),throwErrorTolerant({},f.StrictModeWith)),expectKeyword("with"),expect("("),t=parseExpression(),expect(")"),i=parseStatement(),n.finishWithStatement(t,i)}function parseSwitchCase(){var n,i=[],r,u=new Node;for(matchKeyword("default")?(lex(),n=null):(expectKeyword("case"),n=parseExpression()),expect(":");t<a;){if(match("}")||matchKeyword("default")||matchKeyword("case"))break;r=parseStatement(),i.push(r)}return u.finishSwitchCase(n,i)}function parseSwitchStatement(n){var r,i,u,s,e;if(expectKeyword("switch"),expect("("),r=parseExpression(),expect(")"),expect("{"),i=[],match("}"))return lex(),n.finishSwitchStatement(r,i);for(s=o.inSwitch,o.inSwitch=!0,e=!1;t<a;){if(match("}"))break;u=parseSwitchCase(),u.test===null&&(e&&throwError({},f.MultipleDefaultsInSwitch),e=!0),i.push(u)}return o.inSwitch=s,expect("}"),n.finishSwitchStatement(r,i)}function parseThrowStatement(n){var t;return expectKeyword("throw"),peekLineTerminator()&&throwError({},f.NewlineAfterThrow),t=parseExpression(),consumeSemicolon(),n.finishThrowStatement(t)}function parseCatchClause(){var n,t,i=new Node;return expectKeyword("catch"),expect("("),match(")")&&throwUnexpected(e),n=parseVariableIdentifier(),l&&isRestrictedWord(n.name)&&throwErrorTolerant({},f.StrictCatchVariable),expect(")"),t=parseBlock(),i.finishCatchClause(n,t)}function parseTryStatement(n){var r,t=[],i=null;return expectKeyword("try"),r=parseBlock(),matchKeyword("catch")&&t.push(parseCatchClause()),matchKeyword("finally")&&(lex(),i=parseBlock()),t.length!==0||i||throwError({},f.NoCatchOrFinally),n.finishTryStatement(r,[],t,i)}function parseDebuggerStatement(n){return expectKeyword("debugger"),consumeSemicolon(),n.finishDebuggerStatement()}function parseStatement(){var i=e.type,t,h,r,n;if(i===u.EOF&&throwUnexpected(e),i===u.Punctuator&&e.value==="{")return parseBlock();if(n=new Node,i===u.Punctuator)switch(e.value){case";":return parseEmptyStatement(n);case"(":return parseExpressionStatement(n)}else if(i===u.Keyword)switch(e.value){case"break":return parseBreakStatement(n);case"continue":return parseContinueStatement(n);case"debugger":return parseDebuggerStatement(n);case"do":return parseDoWhileStatement(n);case"for":return parseForStatement(n);case"function":return parseFunctionDeclaration(n);case"if":return parseIfStatement(n);case"return":return parseReturnStatement(n);case"switch":return parseSwitchStatement(n);case"throw":return parseThrowStatement(n);case"try":return parseTryStatement(n);case"var":return parseVariableStatement(n);case"while":return parseWhileStatement(n);case"with":return parseWithStatement(n)}return(t=parseExpression(),t.type===s.Identifier&&match(":"))?(lex(),r="$"+t.name,Object.prototype.hasOwnProperty.call(o.labelSet,r)&&throwError({},f.Redeclaration,"Label",t.name),o.labelSet[r]=!0,h=parseStatement(),delete o.labelSet[r],n.finishLabeledStatement(t,h)):(consumeSemicolon(),n.finishExpressionStatement(t))}function parseFunctionSourceElements(){var n,c=[],i,v,h,y,p,w,b,k,d=new Node;for(expect("{");t<a;){if(e.type!==u.StringLiteral)break;if(i=e,n=parseSourceElement(),c.push(n),n.expression.type!==s.Literal)break;v=r.slice(i.start+1,i.end-1),v==="use strict"?(l=!0,h&&throwErrorTolerant(h,f.StrictOctalLiteral)):!h&&i.octal&&(h=i)}for(y=o.labelSet,p=o.inIteration,w=o.inSwitch,b=o.inFunctionBody,k=o.parenthesizedCount,o.labelSet={},o.inIteration=!1,o.inSwitch=!1,o.inFunctionBody=!0,o.parenthesizedCount=0;t<a;){if(match("}"))break;if(n=parseSourceElement(),typeof n=="undefined")break;c.push(n)}return expect("}"),o.labelSet=y,o.inIteration=p,o.inSwitch=w,o.inFunctionBody=b,o.parenthesizedCount=k,d.finishBlockStatement(c)}function validateParam(n,t,i){var r="$"+i;l?(isRestrictedWord(i)&&(n.stricted=t,n.message=f.StrictParamName),Object.prototype.hasOwnProperty.call(n.paramSet,r)&&(n.stricted=t,n.message=f.StrictParamDupe)):n.firstRestricted||(isRestrictedWord(i)?(n.firstRestricted=t,n.message=f.StrictParamName):isStrictModeReservedWord(i)?(n.firstRestricted=t,n.message=f.StrictReservedWord):Object.prototype.hasOwnProperty.call(n.paramSet,r)&&(n.firstRestricted=t,n.message=f.StrictParamDupe)),n.paramSet[r]=!0}function parseParam(n){var t,i,r;return t=e,i=parseVariableIdentifier(),validateParam(n,t,t.value),match("=")&&(lex(),r=parseAssignmentExpression(),++n.defaultCount),n.params.push(i),n.defaults.push(r),!match(")")}function parseParams(n){var i;if(i={params:[],defaultCount:0,defaults:[],firstRestricted:n},expect("("),!match(")"))for(i.paramSet={};t<a;){if(!parseParam(i))break;expect(",")}return expect(")"),i.defaultCount===0&&(i.defaults=[]),{params:i.params,defaults:i.defaults,stricted:i.stricted,firstRestricted:i.firstRestricted,message:i.message}}function parseFunctionDeclaration(){var o,s=[],h=[],c,n,u,t,i,r,a,v=new Node;return expectKeyword("function"),n=e,o=parseVariableIdentifier(),l?isRestrictedWord(n.value)&&throwErrorTolerant(n,f.StrictFunctionName):isRestrictedWord(n.value)?(i=n,r=f.StrictFunctionName):isStrictModeReservedWord(n.value)&&(i=n,r=f.StrictReservedWord),t=parseParams(i),s=t.params,h=t.defaults,u=t.stricted,i=t.firstRestricted,t.message&&(r=t.message),a=l,c=parseFunctionSourceElements(),l&&i&&throwError(i,r),l&&u&&throwErrorTolerant(u,r),l=a,v.finishFunctionDeclaration(o,s,h,c)}function parseFunctionExpression(){var n,o=null,u,i,r,t,s=[],h=[],c,a,v=new Node;return expectKeyword("function"),match("(")||(n=e,o=parseVariableIdentifier(),l?isRestrictedWord(n.value)&&throwErrorTolerant(n,f.StrictFunctionName):isRestrictedWord(n.value)?(i=n,r=f.StrictFunctionName):isStrictModeReservedWord(n.value)&&(i=n,r=f.StrictReservedWord)),t=parseParams(i),s=t.params,h=t.defaults,u=t.stricted,i=t.firstRestricted,t.message&&(r=t.message),a=l,c=parseFunctionSourceElements(),l&&i&&throwError(i,r),l&&u&&throwErrorTolerant(u,r),l=a,v.finishFunctionExpression(o,s,h,c)}function parseSourceElement(){if(e.type===u.Keyword)switch(e.value){case"const":case"let":return parseConstLetDeclaration(e.value);case"function":return parseFunctionDeclaration();default:return parseStatement()}if(e.type!==u.EOF)return parseStatement()}function parseSourceElements(){for(var n,h=[],i,c,o;t<a;){if(i=e,i.type!==u.StringLiteral)break;if(n=parseSourceElement(),h.push(n),n.expression.type!==s.Literal)break;c=r.slice(i.start+1,i.end-1),c==="use strict"?(l=!0,o&&throwErrorTolerant(o,f.StrictOctalLiteral)):!o&&i.octal&&(o=i)}while(t<a){if(n=parseSourceElement(),typeof n=="undefined")break;h.push(n)}return h}function parseProgram(){var n,t;return skipComment(),peek(),t=new Node,l=!1,n=parseSourceElements(),t.finishProgram(n)}function filterTokenLocation(){for(var n,r,u=[],t=0;t<i.tokens.length;++t)n=i.tokens[t],r={type:n.type,value:n.value},i.range&&(r.range=n.range),i.loc&&(r.loc=n.loc),u.push(r);i.tokens=u}function tokenize(n,f){var l,s;l=String,typeof n=="string"||n instanceof String||(n=l(n)),r=n,t=0,h=r.length>0?1:0,c=0,a=r.length,e=null,o={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},i={},f=f||{},f.tokens=!0,i.tokens=[],i.tokenize=!0,i.openParenToken=-1,i.openCurlyToken=-1,i.range=typeof f.range=="boolean"&&f.range,i.loc=typeof f.loc=="boolean"&&f.loc,typeof f.comment=="boolean"&&f.comment&&(i.comments=[]),typeof f.tolerant=="boolean"&&f.tolerant&&(i.errors=[]);try{if(peek(),e.type===u.EOF)return i.tokens;for(lex();e.type!==u.EOF;)try{lex()}catch(v){if(i.errors){i.errors.push(v);break}else throw v;}filterTokenLocation(),s=i.tokens,typeof i.comments!="undefined"&&(s.comments=i.comments),typeof i.errors!="undefined"&&(s.errors=i.errors)}catch(y){throw y;}finally{i={}}return s}function parse(n,u){var f,s;s=String,typeof n=="string"||n instanceof String||(n=s(n)),r=n,t=0,h=r.length>0?1:0,c=0,a=r.length,e=null,o={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},i={},typeof u!="undefined"&&(i.range=typeof u.range=="boolean"&&u.range,i.loc=typeof u.loc=="boolean"&&u.loc,i.attachComment=typeof u.attachComment=="boolean"&&u.attachComment,i.loc&&u.source!==null&&u.source!==undefined&&(i.source=s(u.source)),typeof u.tokens=="boolean"&&u.tokens&&(i.tokens=[]),typeof u.comment=="boolean"&&u.comment&&(i.comments=[]),typeof u.tolerant=="boolean"&&u.tolerant&&(i.errors=[]),i.attachComment&&(i.range=!0,i.comments=[],i.bottomRightStack=[],i.trailingComments=[],i.leadingComments=[]));try{f=parseProgram(),typeof i.comments!="undefined"&&(f.comments=i.comments),typeof i.tokens!="undefined"&&(filterTokenLocation(),f.tokens=i.tokens),typeof i.errors!="undefined"&&(f.errors=i.errors)}catch(l){throw l;}finally{i={}}return f}var u,v,b,s,p,y,f,w,r,l,t,h,c,a,e,o,i;u={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},v={},v[u.BooleanLiteral]="Boolean",v[u.EOF]="<end>",v[u.Identifier]="Identifier",v[u.Keyword]="Keyword",v[u.NullLiteral]="Null",v[u.NumericLiteral]="Numeric",v[u.Punctuator]="Punctuator",v[u.StringLiteral]="String",v[u.RegularExpression]="RegularExpression",b=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],s={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",ArrowFunctionExpression:"ArrowFunctionExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},p={ArrowParameterPlaceHolder:{type:"ArrowParameterPlaceHolder"}},y={Data:1,Get:2,Set:4},f={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},w={NonAsciiIdentifierStart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢲऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),NonAsciiIdentifierPart:new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԯԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠ-ࢲࣤ-ॣ०-९ॱ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఀ-ఃఅ-ఌఎ-ఐఒ-నప-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಁ-ಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲഁ-ഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟ෦-෯ෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤞᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧ᪰-᪽ᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶ᳸᳹ᴀ-᷵᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚝꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꧠ-ꧾꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︭︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]")},WrappingNode.prototype=Node.prototype={processComment:function(){var t,r,u=i.bottomRightStack,n=u[u.length-1];if(this.type!==s.Program||!(this.body.length>0)){if(i.trailingComments.length>0?i.trailingComments[0].range[0]>=this.range[1]?(r=i.trailingComments,i.trailingComments=[]):i.trailingComments.length=0:n&&n.trailingComments&&n.trailingComments[0].range[0]>=this.range[1]&&(r=n.trailingComments,delete n.trailingComments),n)while(n&&n.range[0]>=this.range[0])t=n,n=u.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=t.leadingComments,t.leadingComments=undefined):i.leadingComments.length>0&&i.leadingComments[i.leadingComments.length-1].range[1]<=this.range[0]&&(this.leadingComments=i.leadingComments,i.leadingComments=[]),r&&(this.trailingComments=r),u.push(this)}},finish:function(){i.range&&(this.range[1]=t),i.loc&&(this.loc.end=new Position,i.source&&(this.loc.source=i.source)),i.attachComment&&this.processComment()},finishArrayExpression:function(n){return this.type=s.ArrayExpression,this.elements=n,this.finish(),this},finishArrowFunctionExpression:function(n,t,i,r){return this.type=s.ArrowFunctionExpression,this.id=null,this.params=n,this.defaults=t,this.body=i,this.rest=null,this.generator=!1,this.expression=r,this.finish(),this},finishAssignmentExpression:function(n,t,i){return this.type=s.AssignmentExpression,this.operator=n,this.left=t,this.right=i,this.finish(),this},finishBinaryExpression:function(n,t,i){return this.type=n==="||"||n==="&&"?s.LogicalExpression:s.BinaryExpression,this.operator=n,this.left=t,this.right=i,this.finish(),this},finishBlockStatement:function(n){return this.type=s.BlockStatement,this.body=n,this.finish(),this},finishBreakStatement:function(n){return this.type=s.BreakStatement,this.label=n,this.finish(),this},finishCallExpression:function(n,t){return this.type=s.CallExpression,this.callee=n,this.arguments=t,this.finish(),this},finishCatchClause:function(n,t){return this.type=s.CatchClause,this.param=n,this.body=t,this.finish(),this},finishConditionalExpression:function(n,t,i){return this.type=s.ConditionalExpression,this.test=n,this.consequent=t,this.alternate=i,this.finish(),this},finishContinueStatement:function(n){return this.type=s.ContinueStatement,this.label=n,this.finish(),this},finishDebuggerStatement:function(){return this.type=s.DebuggerStatement,this.finish(),this},finishDoWhileStatement:function(n,t){return this.type=s.DoWhileStatement,this.body=n,this.test=t,this.finish(),this},finishEmptyStatement:function(){return this.type=s.EmptyStatement,this.finish(),this},finishExpressionStatement:function(n){return this.type=s.ExpressionStatement,this.expression=n,this.finish(),this},finishForStatement:function(n,t,i,r){return this.type=s.ForStatement,this.init=n,this.test=t,this.update=i,this.body=r,this.finish(),this},finishForInStatement:function(n,t,i){return this.type=s.ForInStatement,this.left=n,this.right=t,this.body=i,this.each=!1,this.finish(),this},finishFunctionDeclaration:function(n,t,i,r){return this.type=s.FunctionDeclaration,this.id=n,this.params=t,this.defaults=i,this.body=r,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishFunctionExpression:function(n,t,i,r){return this.type=s.FunctionExpression,this.id=n,this.params=t,this.defaults=i,this.body=r,this.rest=null,this.generator=!1,this.expression=!1,this.finish(),this},finishIdentifier:function(n){return this.type=s.Identifier,this.name=n,this.finish(),this},finishIfStatement:function(n,t,i){return this.type=s.IfStatement,this.test=n,this.consequent=t,this.alternate=i,this.finish(),this},finishLabeledStatement:function(n,t){return this.type=s.LabeledStatement,this.label=n,this.body=t,this.finish(),this},finishLiteral:function(n){return this.type=s.Literal,this.value=n.value,this.raw=r.slice(n.start,n.end),this.finish(),this},finishMemberExpression:function(n,t,i){return this.type=s.MemberExpression,this.computed=n==="[",this.object=t,this.property=i,this.finish(),this},finishNewExpression:function(n,t){return this.type=s.NewExpression,this.callee=n,this.arguments=t,this.finish(),this},finishObjectExpression:function(n){return this.type=s.ObjectExpression,this.properties=n,this.finish(),this},finishPostfixExpression:function(n,t){return this.type=s.UpdateExpression,this.operator=n,this.argument=t,this.prefix=!1,this.finish(),this},finishProgram:function(n){return this.type=s.Program,this.body=n,this.finish(),this},finishProperty:function(n,t,i){return this.type=s.Property,this.key=t,this.value=i,this.kind=n,this.finish(),this},finishReturnStatement:function(n){return this.type=s.ReturnStatement,this.argument=n,this.finish(),this},finishSequenceExpression:function(n){return this.type=s.SequenceExpression,this.expressions=n,this.finish(),this},finishSwitchCase:function(n,t){return this.type=s.SwitchCase,this.test=n,this.consequent=t,this.finish(),this},finishSwitchStatement:function(n,t){return this.type=s.SwitchStatement,this.discriminant=n,this.cases=t,this.finish(),this},finishThisExpression:function(){return this.type=s.ThisExpression,this.finish(),this},finishThrowStatement:function(n){return this.type=s.ThrowStatement,this.argument=n,this.finish(),this},finishTryStatement:function(n,t,i,r){return this.type=s.TryStatement,this.block=n,this.guardedHandlers=t,this.handlers=i,this.finalizer=r,this.finish(),this},finishUnaryExpression:function(n,t){return this.type=n==="++"||n==="--"?s.UpdateExpression:s.UnaryExpression,this.operator=n,this.argument=t,this.prefix=!0,this.finish(),this},finishVariableDeclaration:function(n,t){return this.type=s.VariableDeclaration,this.declarations=n,this.kind=t,this.finish(),this},finishVariableDeclarator:function(n,t){return this.type=s.VariableDeclarator,this.id=n,this.init=t,this.finish(),this},finishWhileStatement:function(n,t){return this.type=s.WhileStatement,this.test=n,this.body=t,this.finish(),this},finishWithStatement:function(n,t){return this.type=s.WithStatement,this.object=n,this.body=t,this.finish(),this}},n.version="2.0.0-dev",n.tokenize=tokenize,n.parse=parse,n.Syntax=function(){var n,t={};typeof Object.create=="function"&&(t=Object.create(null));for(n in s)s.hasOwnProperty(n)&&(t[n]=s[n]);return typeof Object.freeze=="function"&&Object.freeze(t),t}()})},require("MobileServiceClient")})(this||exports);